%% Created by Maple 15.01, Mac OS X
%% Source Worksheet: LAFundamentals.mw
%% Generated: Thu Aug 09 14:01:39 JST 2012
\documentclass{article}
\usepackage{maplestd2e}
\def\emptyline{\vspace{12pt}}
\begin{document}
\pagestyle{empty}
\DefineParaStyle{Maple Heading 1}
\DefineParaStyle{Maple Text Output}
\DefineParaStyle{Maple Dash Item}
\DefineParaStyle{Maple Bullet Item}
\DefineParaStyle{Maple Normal}
\DefineParaStyle{Maple Heading 4}
\DefineParaStyle{Maple Heading 3}
\DefineParaStyle{Maple Heading 2}
\DefineParaStyle{Maple Warning}
\DefineParaStyle{Maple Title}
\DefineParaStyle{Maple Error}
\DefineCharStyle{Maple Hyperlink}
\DefineCharStyle{Maple 2D Math}
\DefineCharStyle{Maple Maple Input}
\DefineCharStyle{Maple 2D Output}
\DefineCharStyle{Maple 2D Input}
\section{\begin{center}
線形代数(I, 入門）\end{center}
}
\begin{maplelatex}\begin{center}
ー数値計算(11/10/21)ー\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{center}
ー数式処理ソフトMaple入門(II)を改訂ー\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{center}
関西学院大学理工学部 西谷滋人\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{flushright}
Copyright @2007-2011 by Shigeto R. Nishitani\end{flushright}
\end{maplelatex}
\section{\textbf{行列と連立方程式と写像}大学でも理系で必修なのは微積分と線形代数です．線形代数というと逆行列と固有値の計算がすぐに思い浮かぶでしょう．計算がややこしくてそれだけでいやになります．でも，行列の計算法は一連の手順で記述できるので，Mapleでは微積分とおなじように一個のコマンドで片が付きます．それが3 x 3以上でも同じです．問題はその意味です．ここでは，線形代数の計算がMapleを使えばどれほど簡単にできるかを示すと共に，線形代数の基本となる概念についてスクリプトと描画を使って，直観的に理解することを目的とします．先ずは連立方程式から入っていきます．中学の時に\begin{center}
\mapleinline{inert}{2d}{4*x = 2}{\[\displaystyle 4\,x=2\]}
\end{center}
というのを解きますよね．一般的には\begin{center}
\mapleinline{inert}{2d}{ax = b}{\[\displaystyle {\it ax}=b\]}
\end{center}
\begin{center}
\mapleinline{inert}{2d}{x = Typesetting:-delayDotProduct(1/a, b, true)}{\[\displaystyle x={\it delayDotProduct} \left( {a}^{-1},b,{\it true} \right) \]}
\end{center}
と書けるというのは皆さんご存知のはず．これと同じようにして連立方程式を書こうというのが逆行列の基本．つまり\begin{center}
\mapleinline{inert}{2d}{Typesetting:-mrow(Typesetting:-mn("2", family = "Times", mathvariant = "normal"), Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mo("+", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2222222em", rspace = "0.2222222em"), Typesetting:-mn("5", family = "Times", mathvariant = "normal"), Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mi("y", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mo("=", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-mn("7", family = "Times", mathvariant = "normal"), Typesetting:-mspace(height = "0.0ex", width = "0.0em", depth = "0.0ex", linebreak = "newline"), Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mn("4", family = "Times", mathvariant = "normal"), Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mo("+", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2222222em", rspace = "0.2222222em"), Typesetting:-mi("y", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mo("=", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-mn("5", family = "Times", mathvariant = "normal"), Typesetting:-mspace(height = "0.0ex", width = "0.0em", depth = "0.0ex", linebreak = "auto"), Typesetting:-mi(""))}{\[\displaystyle 2\mathop{\rm  }x +5\mathop{\rm  }y =7\mathop{\rm  }4\mathop{\rm  }x +y =5\]}
\end{center}
\begin{center}
\mapleinline{inert}{2d}{}{\[\displaystyle \]}
\end{center}
という連立方程式は，係数から作られる２ｘ２行列を係数行列\textbf{\textit{A}}，左辺の値で作るベクトルを\textbf{\textit{b}}として，\begin{center}
\mapleinline{inert}{2d}{Ax = Typesetting:-delayDotProduct(b, x, true) and Typesetting:-delayDotProduct(b, x, true) = Typesetting:-delayDotProduct(1/A, b, true)}{\[\displaystyle {\it Ax}={\it delayDotProduct} \left( b,x,{\it true}\\
\mbox{} \right) {\rm \: \wedge \:}{\it delayDotProduct} \left( b,x,{\it true}\\
\mbox{} \right) ={\it delayDotProduct} \left( {A}^{-1},b,{\it true}\\
\mbox{} \right) \]}
\end{center}
としたいわけです．実際にMapleでやってみましょう．}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{restart:
A:=Matrix([[2,5],[4,1]]);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{A := Matrix(%id = 4399128136)}{\[\displaystyle A\, := \, \left[ \begin {array}{cc} 2&5\\ 4&1\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{b:=Vector([7,5]);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{b := Vector[column](%id = 4333229320)}{\[\displaystyle b\, := \, \left[ \begin {array}{c} 7\\ 5\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{with(LinearAlgebra):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{x0:=MatrixInverse(A).b;
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{x0 := Vector[column](%id = 4334888128)}{\[\displaystyle {\it x0}\, := \, \left[ \begin {array}{c} 1\\ 1\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
と簡単に求めることができます．}\end{Maple Normal}

\end{maplegroup}
\subsection{\textbf{スクリプトの中身}}
\begin{maplelatex}\begin{Maple Normal}{
こちらの欄では，Mapleスクリプトの中身を解説していきます．最初読むときは無視してもらって結構です．(1)行列は英語でMatrixです．こうして行列を作ります．}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
(2)ベクトルは英語でVectorです．これで縦ベクトルができます．}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
代数はlinear algebraと言います．withでLinearAlgebraというライブラリーパッケージを読み込んでおきます．}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
(3)逆行列はmatrix inverseと言います．行列AのMatrixInverseを求めて，ベクトル\textbf{\textit{b}}に掛けています．}\end{Maple Normal}
\end{maplelatex}
\begin{maplegroup}
\begin{Maple Normal}{
次に，これを2次元上のグラフで見てみましょう．}\end{Maple Normal}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{with(plots):with(plottools):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{p0:=convert(x0,list);
p1:=convert(b,list);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{p0 := [1, 1]}{\[\displaystyle {\it p0}\, := \,[1,1]\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{p1 := [7, 5]}{\[\displaystyle {\it p1}\, := \,[7,5]\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{point1:=[disk(p0,0.2,color=red),
  disk(p1,0.2,color=blue)]:
line1:=arrow(p0,p1,.05,.3,.1 ):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
これ以降は描画関連の操作です．}\end{Maple Normal}

\begin{Maple Normal}{
先ず描画に必要なライブラリーパッケージ(plotsおよびplottools)をwithで読み込んでおきます．}\end{Maple Normal}

\begin{Maple Normal}{
(4)ベクトルを位置座標を意味するようにlistへ変換(convert)しておきます．}\end{Maple Normal}

\begin{Maple Normal}{
位置p0に円(disk)を半径0.2,赤色で描きます．同じように位置p1に半径0.2，青色でdiskを描きます．もう一つ，p0からp1に向かう矢印(arrow)を適当な大きさで描きます．後ろの数字をいじると線の幅や矢印の大きさが変わります．}\end{Maple Normal}

\begin{Maple Normal}{
これらをまとめて表示(display)します．このとき，表示範囲を-8..8,-8..8とします．}\end{Maple Normal}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{display(point1,line1,view=[-2..8,-2..8],gridlines=true);
}{}
\end{mapleinput}
\mapleresult
\MaplePlot{80mm}{./figures/LAFundamentalsplot2d1.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
逆行列は}\end{Maple Normal}

\textbf{MatrixInverse(A);}\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{Matrix(%id = 4411682392)}{\[\displaystyle  \left[ \begin {array}{cc} -1/18&{\frac {5}{18}}\\ 2/9&-1/9\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
で求まります．先ほどの矢印を逆に青から赤へたどる変換になっています．これが，連立方程式を解く様子をグラフで示しています．つまり，行列Aで示される変換によって求まる青点で示したベクトル\textbf{\textit{b}}(7,5)を指す元の赤点を捜すというものです．答えは(1,1)となります．}\end{Maple Normal}

\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
では，元の赤点をもう少しいろいろ取って，行列Aでどのような点へ写されるかを見てみましょう．}\end{Maple Normal}

\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{N:=30:point2:=[]:line2:=[]:
for k from 0 to N-1 do
 x0:=Vector([sin(2*Pi*k/N),cos(2*Pi*k/N)]);
 x1:=A.x0;
 p0:=convert(x0,list);
 p1:=convert(x1,list);
 point2:=[op(point2),disk(p0,0.05,color=red)];
 point2:=[op(point2),disk(p1,0.05,color=blue)];
 line2:=[op(line2),line(p0,p1)];
end do:}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplegroup}
\begin{maplelatex}\begin{Maple Normal}{
先ほどの描画と使っているコマンドはほぼ同じです．ただし，スクリプトに特有の2つの新しいテクを使ってます．この基本形をとり出すと，}\end{Maple Normal}
\end{maplelatex}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{list1:=[];
for k from 0 to 2 do
  list1:=[op(list1),k];
end do;
list1;
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{list1 := []}{\[\displaystyle {\it list1}\, := \,[]\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{list1 := [0]}{\[\displaystyle {\it list1}\, := \,[0]\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{list1 := [0, 1]}{\[\displaystyle {\it list1}\, := \,[0,1]\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{list1 := [0, 1, 2]}{\[\displaystyle {\it list1}\, := \,[0,1,2]\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{[0, 1, 2]}{\[\displaystyle [0,1,2]\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
となります．for-loopでkを0から4まで回し，list1に次々と値を追加していくというテクです．N:=30で分割した円周上の点をx0で求めて，point2にその円とそれのＡ.x0を，line2にはその2点を結ぶline(線)を足しています．}\end{Maple Normal}

\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
次の図を見てください．}\end{Maple Normal}

\textbf{d:=6;}\textbf{display(point2,line2,view=[-d..d,-d..d]);}\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{d := 6}{\[\displaystyle d\, := \,6\]}
\end{maplelatex}
\mapleresult
\MaplePlot{80mm}{./figures/LAFundamentalsplot2d2.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
何やっているか分かります? 赤点で示される円が，青点で示される楕円へ写されていることが分かるでしょう．}\end{Maple Normal}

\end{maplegroup}
\section{\textbf{【課題1】固有ベクトル}}
\begin{maplelatex}\begin{Maple Normal}{
では，ここでクイズです．固有ベクトルは上のグラフの何処に対応するか?}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
ヒントは，「行列Aの固有値，固有ベクトルを\mapleinline{inert}{2d}{`&lambda;，`*x[0]}{$\displaystyle \lambda \mbox {{\tt ，}}\,x_{{0}}$}
とすると，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{Typesetting:-delayDotProduct(A, x[0], true) = Typesetting:-delayDotProduct(lambda, x[0], true)}{\[\displaystyle {\it delayDotProduct} \left( A,x_{{0}},{\it true} \right) ={\it delayDotProduct} \left( \lambda\\
\mbox{},x_{{0}},{\it true} \right) \]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
が成立する」です．}\end{Maple Normal}
\end{maplelatex}
\begin{maplegroup}
\begin{Maple Normal}{
固有値と固有ベクトルはMapleでは以下のコマンドで求まります．}\end{Maple Normal}

\textbf{lambda,P:=Eigenvectors(A);}\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{lambda, P := Vector[column](%id = 4418305840), Matrix(%id = 4418383728)}{\[\displaystyle \lambda,\,P\, := \, \left[ \begin {array}{c} -3\\ 6\end {array} \right] ,\, \left[ \begin {array}{cc} -1&5/4\\ 1&1\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
ここではMapleコマンドのEigenvectorsで戻り値を\mapleinline{inert}{2d}{lambda}{$\displaystyle \lambda$}
(lambdaと書きます)，\textbf{\textit{P}}に代入しています．この後ろ側にある行列\textbf{\textit{P}}の1列目で構成されるベクトルが固有値-3に対応する固有ベクトル，2列目のベクトルが固有値6に対応する固有ベクトルです．}\end{Maple Normal}

\end{maplegroup}
\subsection{\textbf{解答}}
\begin{maplegroup}
\begin{Maple Normal}{
固有値\mapleinline{inert}{2d}{lambda}{$\displaystyle \lambda$}
，固有ベクトル\mapleinline{inert}{2d}{x[0]}{$\displaystyle x_{{0}}$}
の関係式}\end{Maple Normal}

\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{Typesetting:-delayDotProduct(A, x[0], true) = Typesetting:-delayDotProduct(lambda, x[0], true)}{\[\displaystyle {\it delayDotProduct} \left( A,x_{{0}},{\it true} \right) ={\it delayDotProduct} \left( \lambda\\
\mbox{},x_{{0}},{\it true} \right) \]}
}\end{Maple Normal}
\end{center}
\begin{Maple Normal}{
を言葉で言い直すと，}\end{Maple Normal}

\begin{Maple Normal}{
「固有ベクトル\mapleinline{inert}{2d}{x[0]}{$\displaystyle x_{{0}}$}
は変換行列\mapleinline{inert}{2d}{A}{$\displaystyle A$}
によって，自分の固有値倍のベクトル\mapleinline{inert}{2d}{x[0]}{$\displaystyle x_{{0}}$}
に写されるベクトル」}\end{Maple Normal}

\begin{Maple Normal}{
となります．つまり変換の図で言うと，}\end{Maple Normal}

\begin{Maple Normal}{
「変換しても方向が変わらない赤点」}\end{Maple Normal}

\begin{Maple Normal}{
となります．これは図で書くと}\end{Maple Normal}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{vv1:=Column(P,1):
vv2:=Column(P,2):
a1:=vv1[2]/vv1[1]:
a2:=vv2[2]/vv2[1]:
pp1:=plot(\{a2*x,a1*x\},x=-d..d):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
Columnによって行列の第\textit{i}列目をとりだし，その比によって直線の傾きを求めています．そうして引いた2本の直線をpp1としてため込んで，先ほど描いた変換の図に加えて表示(display)させます．}\end{Maple Normal}
\textbf{}\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{display(point2,line2,pp1,view=[-d..d,-d..d]);
#display(point2,line2,view=[-d..d,-d..d]);
}{}
\end{mapleinput}
\mapleresult
\MaplePlot{80mm}{./figures/LAFundamentalsplot2d3.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
上記出力は，解答をかくすためにpp1を外しています．pp1も入れて描いた直線が引かれた方向ではたしかに変換によっても方向が変わらなさそうに見えるでしょう．}\end{Maple Normal}

\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
ついでに行列の対角化は次のようにしてできます．}\end{Maple Normal}

\textbf{MatrixInverse(P).A.P;}\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{Matrix(%id = 4422935216)}{\[\displaystyle  \left[ \begin {array}{cc} -3&0\\ 0&6\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\section{\textbf{【課題2】好きな行列を表示させて}}
\begin{maplegroup}
\begin{Maple Normal}{
では，好きな行列をつくって同じようにして図や固有ベクトルを表示させてください．ただし，ここでは次のDeterminantで求まる行列\textbf{\textit{A}}の行列式が０とならないようお願いします．}\end{Maple Normal}

\textbf{Determinant(A);}\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{-18}{\[\displaystyle -18\]}
\end{maplelatex}
\end{maplegroup}
\section{\textbf{【課題3】行列式の意味}}
\begin{maplegroup}
\begin{Maple Normal}{
では次のクイズ．先ほど求めた，行列\textbf{\textit{A}}の行列式は，どこに対応するでしょう? 以下の(1,0),(0,1)の点を変換した点に原点からベクトルを結んでその意味を説明してください．さらに，そのマイナスの意味は？．}\end{Maple Normal}

\end{maplegroup}
\subsection{解答}
\begin{maplegroup}
\begin{Maple Normal}{
変換によって[1,0]と[0,1]のベクトルがどの点へ移るかを表示したのが次の図です．}\end{Maple Normal}

\textbf{point3:=[]:line3:=[]:}\textbf{XX:=Matrix([[1,0],[0,1]]):}\textbf{for i from 1 to 2 do}\textbf{x0:=Column(XX,i);}\textbf{x1:=A.x0;}\textbf{p0:=convert(x0,list):}\textbf{p1:=convert(x1,list):}\textbf{point3:=[op(point3),disk(p0,0.2,color=red),disk(p1,0.2,color=blue)]:

\#}\textbf{point3:=[op(point3),disk(p0,0.2,color=red)]:}\textbf{line3:=[op(line3),arrow([0,0],p0,.05,.3,.1 ),arrow([0,0],p1,.05,.3,.1 )]:

\#}\textbf{line3:=[op(line3),arrow([0,0],p0,.05,.3,.1 )]:}\textbf{end do:}\textbf{display(point3,line3,view=[-1..8,-1..8],}\textbf{gridlines=true}\textbf{);}\mapleresult
\MaplePlot{80mm}{./figures/LAFundamentalsplot2d4.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
(上のスクリプトの行頭に\#がある2行をその直下の式と入れ替えると意図する解答が出ます．お試しあれ．）}\end{Maple Normal}

\end{maplegroup}
\section{\textbf{行列式が0の写像}}
\begin{maplegroup}
\begin{Maple Normal}{
では，行列式が０になるというのはどういう状態でしょう? 次のような行列を考えてみましょう．}\end{Maple Normal}

\textbf{A:=Matrix([[2,1],[4,2]]);}\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{A := Matrix(%id = 4424357016)}{\[\displaystyle A\, := \, \left[ \begin {array}{cc} 2&1\\ 4&2\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
この行列式は}\end{Maple Normal}

\textbf{Determinant(A);}\begin{Maple Normal}{
です．これで上と同じように表示させてみましょう．}\end{Maple Normal}

\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{0}{\[\displaystyle 0\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{N:=30:point2:=[]:line2:=[]:
for k from 0 to N-1 do
x0:=Vector([sin(2*Pi*k/N),cos(2*Pi*k/N)]);
x1:=A.x0;
p0:=convert(x0,list);
p1:=convert(x1,list);
point2:=[op(point2),disk(p0,0.05,color=red),disk(p1,0.05,color=blue)];
line2:=[op(line2),line(p0,p1)];
end:
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{d:=6;
display(point2,line2,view=[-d..d,-d..d]);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{d := 6}{\[\displaystyle d\, := \,6\]}
\end{maplelatex}
\mapleresult
\MaplePlot{80mm}{./figures/LAFundamentalsplot2d5.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
わかります？ 今回の移動先の青点は直線となっています．つまり，determinantが0ということは，変換すると面積がつぶれるという事を意味しています．平面がひとつ次元を落として線になるということです．では，この行列の表わす写像によって原点(0,0)に写される元の座標を求めてみます．連立方程式に戻してみると}\end{Maple Normal}

\textbf{A.Vector([x,y])=Vector([0,0]);}\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{Vector[column](%id = 4425084520) = Vector[column](%id = 4425148720)}{\[\displaystyle  \left[ \begin {array}{c} 2\,x+y\\ 4\,x+2\,y\end {array} \right] = \left[ \begin {array}{c} 0\\ 0\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
となります．とよく見ると，1行目も2行目もおなじ式になっています．2次元正方行列で，行列式が0の時には必ずこういう形になり，直線の式となります．これを表示すると左図の赤線となります．この直線上の全ての点が[0,0]へ写されることを確認してください．また，緑の線上の点は全て[1,2]へ写されることが確認できます．}\end{Maple Normal}

\textbf{A.Vector([-1,2]);}\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{Vector[column](%id = 4427619248)}{\[\displaystyle  \left[ \begin {array}{c} 0\\ 0\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{plot([-2*x,-2*x+1,-2*x-1],x=-4..4,y=-4..4);
}{}
\end{mapleinput}
\mapleresult
\MaplePlot{80mm}{./figures/LAFundamentalsplot2d6.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{plot([2*x],x=-4..4,y=-4..4,color=blue);
}{}
\end{mapleinput}
\mapleresult
\MaplePlot{80mm}{./figures/LAFundamentalsplot2d7.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
こうしてすべて調べていけば，左の平面上のすべて点は右の青の直線上へ写されることが分かります．今まで見てきた円と楕円とはまったく違った写像が，行列式が0の行列では起こっていることが分かると思います．右の青線を行列Aによる像(Image, Im\textbf{\textit{A}}と表記)，左の赤線，つまり写像によって[0,0]へ写される集合を核(Kernel, Ker\textbf{\textit{A}}と表記)と呼びます．}\end{Maple Normal}

\end{maplegroup}
\begin{maplegroup}
\begin{center}
\begin{Maple Normal}{
}\end{Maple Normal}
\end{center}
\begin{center}
\begin{Maple Normal}{
像(Image)}\end{Maple Normal}
\end{center}
\textbf{}\end{maplegroup}
\begin{maplegroup}
\begin{center}
\begin{Maple Normal}{
}\end{Maple Normal}
\end{center}
\begin{center}
\begin{Maple Normal}{
核(Kernel)}\end{Maple Normal}
\end{center}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
行列\textbf{\textit{A}}による写像を\textit{f}として，赤点に限らず元の点の集合を\textit{V}, 移った先の点の集合を\textit{W}として，}\end{Maple Normal}

\begin{center}
\begin{Maple Normal}{
\textit{f}:\textit{V}->\textit{W}}\end{Maple Normal}
\end{center}
\begin{Maple Normal}{
と表記されます．\textit{v,w}を\textit{V,W}の要素としたとき，違う\textit{v}が違う\textit{w}に写されることを単射，全ての\textit{w}に対応する\textit{v}がある写像を全射と言います．全単射，つまり全射でかつ単射，だと要素は一対一に対応します．}\end{Maple Normal}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
先ほどの}\end{Maple Normal}

\textbf{A;}\begin{Maple Normal}{
は全射でもなく，単射でもない例です．}\end{Maple Normal}

\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{Matrix(%id = 4427618768)}{\[\displaystyle  \left[ \begin {array}{cc} 2&1\\ 4&2\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
行列式が0の場合の写像は単射ではありません．このとき，逆写像が作れそうにありません．これを連立方程式に戻して考えましょう．もともと，}\end{Maple Normal}

\begin{center}
\begin{Maple Normal}{
\textit{v}=\mapleinline{inert}{2d}{1/A}{$\displaystyle {A}^{-1}$}
\textit{w}}\end{Maple Normal}
\end{center}
\begin{Maple Normal}{
の解\textit{v}は点\textit{w}が写像\textbf{\textit{A}}によってどこから写されてきたかという意味を持ちます．逆写像が作れない場合は，連立方程式の解はパラメータをひとつ持った複数の解(直線)となります．これが係数行列の行列式が0の場合に，連立方程式の解が不定となる，あるいは像がつぶれるという関係です．}\end{Maple Normal}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
行列の次元が高い場合には，いろいろなつぶれかたをします．行列の階数と次元は}\end{Maple Normal}

\begin{mapleinput}
\mapleinline{active}{1d}{Rank(A);
Dimension(A);
}{}
\end{mapleinput}
\begin{Maple Normal}{
で求まります．}\end{Maple Normal}

\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{1}{\[\displaystyle 1\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{2, 2}{\[\displaystyle 2,\,2\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
\textbf{\textit{A}}を\textit{m}行\textit{n}列の行列とするとき，}\end{Maple Normal}

\begin{center}
\begin{Maple Normal}{
Rank(\textbf{\textit{A}}) = Dimension (Im\textbf{\textit{A}})}\end{Maple Normal}
\end{center}
\begin{center}
\begin{Maple Normal}{
Dimension (Ker\textbf{\textit{A}}) =\textit{n}- Rank(\textbf{\textit{A}})}\end{Maple Normal}
\end{center}
\begin{Maple Normal}{
が成立し，これを次元定理といいます．}\end{Maple Normal}
\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
全射と単射の関係は，下の表のような一変数の方程式での解の性質の拡張と捉えることができます．}\end{Maple Normal}

\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
\textit{a x}=\textit{b}}\end{Maple Normal}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{\begin{Maple Normal}{
一意 a<>0 x=b/a}\end{Maple Normal}

\begin{Maple Normal}{
不定 a=0, b=0 解は無数}\end{Maple Normal}

\begin{Maple Normal}{
不能 a=0, b<>0 解は存在しない}\end{Maple Normal}
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{\begin{Maple Normal}{
m x n行列A}\end{Maple Normal}

\begin{Maple Normal}{
全射でない(Im A < m)}\end{Maple Normal}

\begin{Maple Normal}{
値域上にあるときのみ解が存在}\end{Maple Normal}

\begin{Maple Normal}{
全射(Im A =m)}\end{Maple Normal}

\begin{Maple Normal}{
解は必ず存在}\end{Maple Normal}

\begin{Maple Normal}{
単射でない}\end{Maple Normal}

\begin{Maple Normal}{
Ker A <> 0}\end{Maple Normal}

\begin{Maple Normal}{
解は複数}\end{Maple Normal}

\begin{Maple Normal}{
}\end{Maple Normal}
\begin{Maple Normal}{
単射}\end{Maple Normal}

\begin{Maple Normal}{
Ker A = 0}\end{Maple Normal}

\begin{Maple Normal}{
解はひとつ}\end{Maple Normal}
}{}
\end{mapleinput}
\end{maplegroup}
\section{\textbf{課題}}
\subsection{下の図は}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{A := Matrix(%id = 4429393776)}{\[\displaystyle A\, := \, \left[ \begin {array}{cc} 3&2/3\\ 2/3&2\end {array} \right] \]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
を用いて変換される像を表わしている．この行列の固有値，行列式が何処に対応するか説明せよ．また，固有ベクトルの方向を記せ．(2007年度期末試験)}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\MaplePlot{80mm}{./figures/LAFundamentalsplot2d8.eps}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\end{document}
