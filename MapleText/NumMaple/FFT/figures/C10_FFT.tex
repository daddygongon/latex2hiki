%% Created by Maple 15.01, Mac OS X
%% Source Worksheet: C10_FFT.mw
%% Generated: Thu Aug 16 17:06:18 JST 2012
\documentclass{article}
\usepackage{maplestd2e}
\def\emptyline{\vspace{12pt}}
\begin{document}
\pagestyle{empty}
\DefineParaStyle{Maple Heading 1}
\DefineParaStyle{Maple Text Output}
\DefineParaStyle{Maple Dash Item}
\DefineParaStyle{Maple Bullet Item}
\DefineParaStyle{Maple Normal}
\DefineParaStyle{Maple Heading 4}
\DefineParaStyle{Maple Heading 3}
\DefineParaStyle{Maple Heading 2}
\DefineParaStyle{Maple Warning}
\DefineParaStyle{Maple Title}
\DefineParaStyle{Maple Error}
\DefineCharStyle{Maple Hyperlink}
\DefineCharStyle{Maple 2D Math}
\DefineCharStyle{Maple Maple Input}
\DefineCharStyle{Maple 2D Output}
\DefineCharStyle{Maple 2D Input}
\section{\begin{center}
\textbf{FFT(Fast Fourier Transformation)}\end{center}
}
\begin{maplelatex}\begin{center}
ー数値計算(11/12/16, 12/1/6)ー\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{center}
関西学院大学理工学部 西谷滋人\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{flushright}
Copyright @2007-12 by Shigeto R. Nishitani\end{flushright}
\end{maplelatex}
\section{\textbf{FFTの応用}}
\begin{maplelatex}\begin{Maple Normal}{
Fast Fourier Transformation(FFT)高速フーリエ変換(あるいはデジタル(離散)フーリエ変換(DFT))は，周波数分解やフィルターを初め，画像処理などの多くの分野で使われている．基本となる考え方は，直交基底による関数の内挿法である．最初にその応用例を見た後，どのような理屈でFFTが動いているかを解説する．}\end{Maple Normal}
\end{maplelatex}
\subsection{\textbf{周波数分解}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{restart:
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{data1:=[];
for i from 1 to 256 do
  data1:=[op(data1),evalf(sin(i/13))+evalf(sin(i/2))];
end do:
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{data1 := []}{\[\displaystyle {\it data1}\, := \,[]\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{plot([sin(x/13),sin(x/2)],x=0..300);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{C10_FFTplot2d1.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{with(plots):
listplot(data1);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{C10_FFTplot2d2.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{X:=array(data1):
Y:=array(1..256,sparse):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{FFT(8,X,Y);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{256}{\[\displaystyle 256\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{Data2:=[seq([i,sqrt(X[i]\symbol{94}2+Y[i]\symbol{94}2)],i=1..128)]:
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{plot(Data2);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{C10_FFTplot2d3.eps}
\end{maplegroup}
\subsection{\textbf{高周波フィルター}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{f1:=t->subs(a=10,b=40000,c=380,d=128,a+b/(c+(t-d)\symbol{94}2));
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{f1 := proc (t) options operator, arrow; subs(a = 10, b = 40000, c = 380, d = 128, a+b/(c+(t-d)^2)) end proc}{\[\displaystyle {\it f1}\, := \,t\mapsto 10+40000\, \left( 380+ \left( t-128 \right) ^{2} \right) ^{-1}\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{plot(f1(t),t=1..256);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{C10_FFTplot2d4.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{T:=[seq(f1(i)*(0.6+0.8*evalf(rand()/10\symbol{94}12)),i=1..256)]:
#T:=[seq(evalf(rand()/10\symbol{94}12),i=1..256)]:
#T:=[seq(f1(i),i=1..256)]:
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{with(plots):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{listplot(T);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{C10_FFTplot2d5.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{Idata:=array([seq(0,i=1..256)]):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{Rdata:=convert(T,array):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{FFT(8,Rdata,Idata);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{256}{\[\displaystyle 256\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{Adata:=[seq([i,sqrt(Idata[i]\symbol{94}2+Rdata[i]\symbol{94}2)],i=1..128)]:
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{plot(Adata);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{C10_FFTplot2d6.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{filter:=x->piecewise(x>=0 and x<=20,(1-x/20)):
#filter:=x->piecewise(x>=0 and x<=20,1);
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{plot(filter(x),x=0..40);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{C10_FFTplot2d7.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{FRdata:=array([seq(Rdata[i]*filter(i),i=1..256)]):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{FIdata:=array([seq(Idata[i]*filter(i),i=1..256)]):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{iFFT(8,FRdata,FIdata);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{256}{\[\displaystyle 256\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{listplot(FRdata);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{C10_FFTplot2d8.eps}
\end{maplegroup}
\section{\textbf{FFTの動作原理}}
\begin{maplelatex}\begin{Maple Normal}{
このように便利なFFTであるが，どのような理屈で導かれるのか？　Fourier変換法は，この課題だけでも何回ものコマ数が必要なほどの内容を含んでいる．ここでは，その基本となる考え方（のひとつ)だけを提示する．}\end{Maple Normal}
\end{maplelatex}
\begin{maplegroup}
関数の内挿で導入した基底関数を\textbf{直交関数系}でとる．ところが，展開係数を逆行列で求める手法では計算が破綻．
\textbf{直交関係}からの積分による係数決定．
\textbf{選点直交性}による計算の簡素化．
高速フーリエ変換アルゴリズムによる高速化．\end{maplegroup}
\subsection{\textbf{関数内挿としてのFourier関数系}}
\begin{maplelatex}\begin{Maple Normal}{
一連の関数系による関数の内挿は，基底関数を\mapleinline{inert}{2d}{phi[n](x)}{$\displaystyle \phi_{{n}} \left( x \right) $}
として}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{F(x) = sum(a[n]*`&varphi;`[n](x), n = 1 .. N)}{\[\displaystyle F \left( x \right) =\sum _{n=1}^{N}a_{{n}}\varphi _{{n}} \left( x \right) \]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{flushright}
\begin{Maple Normal}{
(1)}\end{Maple Normal}
\end{flushright}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
で得られることを見た．}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
Fourier変換では基底関数として\mapleinline{inert}{2d}{`&varphi;`[n](x) = sin(2*`&pi;nx`), cos(2*`&pi;nx`)}{$\displaystyle \varphi _{{n}} \left( x \right) =\sin \left( 2\,\pi {\it nx} \right) ,\,\cos \left( 2\,\pi {\it nx} \right) $}
をとる．関数の内挿法で示したように，この\mapleinline{inert}{2d}{x[i]}{$\displaystyle x_{{i}}$}
での値\mapleinline{inert}{2d}{f[i], i = `&ctdot;`(1, M)}{$\displaystyle f_{{i}},\,i=\mbox {{\tt `\&ctdot;`}} \left( 1,M \right) $}
と，近似の次数(\mapleinline{inert}{2d}{N}{$\displaystyle N$}
)とでつくる，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{Typesetting:-mrow(Typesetting:-mi("A", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mo("=", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-maction(Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mtable(Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("&varphi;", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("0", family = "Times", mathvariant = "normal")), subscriptshift = "0"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("0", family = "Times", mathvariant = "normal")), subscriptshift = "0")), family = "Times", mathvariant = "normal")), Typesetting:-mi("")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("&varphi;", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), subscriptshift = "0"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("0", family = "Times", mathvariant = "normal")), subscriptshift = "0")), family = "Times", mathvariant = "normal")), Typesetting:-mi("")), Typesetting:-mi("")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&ctdot;", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("&varphi;", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mi("N", family = "Times", italic = "true", mathvariant = "italic")), subscriptshift = "0"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("0", family = "Times", mathvariant = "normal")), subscriptshift = "0")), family = "Times", mathvariant = "normal")), Typesetting:-mi("")), Typesetting:-mi("")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mo("&vellip;", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mo("&vellip;", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&vellip;", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mo("&vellip;", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("&varphi;", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("0", family = "Times", mathvariant = "normal")), subscriptshift = "0"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mi("M", family = "Times", italic = "false", mathvariant = "normal")), subscriptshift = "0")), family = "Times", mathvariant = "normal")), Typesetting:-mi("")), Typesetting:-mi("")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("&varphi;", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), subscriptshift = "0"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mi("M", family = "Times", italic = "false", mathvariant = "normal")), subscriptshift = "0")), family = "Times", mathvariant = "normal")), Typesetting:-mi("")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mo("&ctdot;", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("&varphi;", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mi("N", family = "Times", italic = "true", mathvariant = "italic")), subscriptshift = "0"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mi("M", family = "Times", italic = "false", mathvariant = "normal")), subscriptshift = "0")), family = "Times", mathvariant = "normal")), Typesetting:-mi("")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), align = "axis", rowalign = "baseline", columnalign = "center", groupalign = "{left}", alignmentscope = "true", columnwidth = "auto", width = "auto", rowspacing = "1.0ex", columnspacing = "0.8em", rowlines = "none", columnlines = "none", frame = "none", framespacing = "0.4em 0.5ex", equalrows = "false", equalcolumns = "false", displaystyle = "false", side = "right", minlabelspacing = "0.8em"), Typesetting:-mi("")), family = "Times", mathvariant = "normal", Typesetting:-msemantics = "Matrix", open = "[", close = "]", Typesetting:-msemantics = "Matrix"), actiontype = "rtableaddress"), Typesetting:-mi("")), Typesetting:-mi(""))}{\[\displaystyle A =\]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
とした係数行列を求めて，係数\mapleinline{inert}{2d}{a[i]}{$\displaystyle a_{{i}}$}
とデータ点\mapleinline{inert}{2d}{f[i]}{$\displaystyle f_{{i}}$}
をそれぞれベクトルと考えると，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{A*a = f}{\[\displaystyle Aa=f\]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
から，通常の逆行列を求める手法で係数を決定することもできる．しかし，この強引な方法はデータ数，関数の次数が多い，フーリエ変換が対象としようとする問題では破綻する．もっといい方法が必要で，それが直交関数系では存在する．}\end{Maple Normal}
\end{maplelatex}
\subsection{\textbf{直交関係からの積分による係数決定}}
\begin{maplelatex}\begin{Maple Normal}{
関数の直交関係は，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{int(`&varphi;`[n](x)*`&varphi;`[m](x), x = a .. b) = delta[mn]*C[n] and delta[mn]*C[n] = Vector[column](%id = 4515442072)}{\[\displaystyle \int _{a}^{b}\!\varphi _{{n}} \left( x \right) \varphi _{{m}} \left( x \right) {dx}=\delta_{{{\it mn}}}C_{{n}}{\rm \: \wedge \:}\delta_{{{\it mn}}}C_{{n}}\\
\mbox{}= \left[ \begin {array}{c} C_{{m}}{\it at}\,m=n\\ \noalign{\medskip}0\neq n\end {array} \right] \]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
である．\mapleinline{inert}{2d}{C[m]*`は`}{$\displaystyle C_{{m}}\mbox {{\tt は}}$}
}\end{Maple Normal}
\end{maplelatex}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{plot([sin(x),sin(3*x)],x=0..2*Pi);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{C10_FFTplot2d9.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{plot([sin(x)*sin(3*x)],x=0..2*Pi,
color=black);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{C10_FFTplot2d10.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{int(sin(x)*sin(3*x),x=0..2*Pi);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{0}{\[\displaystyle 0\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{for i from 1 to 3 do
for j from 1 to 3 do
S:=int(sin(i*x)*sin(j*x),x=0..2*Pi);
print(i,j,S);
end do;
end do:
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{1, 1, Pi}{\[\displaystyle 1,\,1,\,\pi \]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{1, 2, 0}{\[\displaystyle 1,\,2,\,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{1, 3, 0}{\[\displaystyle 1,\,3,\,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{2, 1, 0}{\[\displaystyle 2,\,1,\,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{2, 2, Pi}{\[\displaystyle 2,\,2,\,\pi \]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{2, 3, 0}{\[\displaystyle 2,\,3,\,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{3, 1, 0}{\[\displaystyle 3,\,1,\,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{3, 2, 0}{\[\displaystyle 3,\,2,\,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{3, 3, Pi}{\[\displaystyle 3,\,3,\,\pi \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{int(F(x)*`&varphi;`[m](x), x = a .. b)}{\[\displaystyle \int _{a}^{b}\!F \left( x \right) \varphi _{{m}} \left( x \right) {dx}\]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
を考える．先程の(1)式をいれると}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{Typesetting:-mrow(Typesetting:-msubsup(Typesetting:-mo("&Integral;", family = "Times", mathvariant = "normal", fence = "unset", separator = "unset", stretchy = "true", symmetric = "unset", largeop = "true", movablelimits = "unset", accent = "unset", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mrow(Typesetting:-mi("a", family = "Times", italic = "true", mathvariant = "italic")), Typesetting:-mrow(Typesetting:-mi("b", family = "Times", italic = "true", mathvariant = "italic")), superscriptshift = "0", subscriptshift = "0"), Typesetting:-mi("F", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic")), family = "Times", mathvariant = "normal"), Typesetting:-msub(Typesetting:-mi("&varphi;", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mi("m", family = "Times", italic = "true", mathvariant = "italic")), subscriptshift = "0"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic")), family = "Times", mathvariant = "normal"), Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mo("&DifferentialD;", family = "Times", mathvariant = "normal", fence = "unset", separator = "unset", stretchy = "unset", symmetric = "unset", largeop = "unset", movablelimits = "unset", accent = "unset", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mo("=", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-msubsup(Typesetting:-mo("&Integral;", family = "Times", mathvariant = "normal", fence = "unset", separator = "unset", stretchy = "true", symmetric = "unset", largeop = "true", movablelimits = "unset", accent = "unset", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mrow(Typesetting:-mi("a", family = "Times", italic = "true", mathvariant = "italic")), Typesetting:-mrow(Typesetting:-mi("b", family = "Times", italic = "true", mathvariant = "italic")), superscriptshift = "0", subscriptshift = "0"), Typesetting:-munderover(Typesetting:-mo("&Sum;", family = "Times", mathvariant = "normal", fence = "unset", separator = "unset", stretchy = "true", symmetric = "unset", largeop = "true", movablelimits = "true", accent = "unset", lspace = "0.0em", rspace = "0.1666667em"), Typesetting:-mrow(Typesetting:-mi("n", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mo("=", family = "Times", mathvariant = "normal", fence = "unset", separator = "unset", stretchy = "unset", symmetric = "unset", largeop = "unset", movablelimits = "unset", accent = "unset", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-mn("1", family = "Times", mathvariant = "normal")), Typesetting:-mrow(Typesetting:-mi("N", family = "Times", italic = "true", mathvariant = "italic")), accent = "false", accentunder = "false"), Typesetting:-msub(Typesetting:-mi("a", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mi("n", family = "Times", italic = "true", mathvariant = "italic")), subscriptshift = "0"), Typesetting:-msub(Typesetting:-mi("&varphi;", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mi("n", family = "Times", italic = "true", mathvariant = "italic")), subscriptshift = "0"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic")), family = "Times", mathvariant = "normal"), Typesetting:-mi(""), Typesetting:-msub(Typesetting:-mi("&varphi;", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mi("m", family = "Times", italic = "true", mathvariant = "italic")), subscriptshift = "0"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic")), family = "Times", mathvariant = "normal"), Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mo("&DifferentialD;", family = "Times", mathvariant = "normal", fence = "unset", separator = "unset", stretchy = "unset", symmetric = "unset", largeop = "unset", movablelimits = "unset", accent = "unset", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mo("=", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"))}{$\displaystyle \int _{a }^{b }F \left(x \right)\varphi _{m }\left(x \right)\mathop{\rm  }d x =\int _{a }^{b }\Mapleoverset{N }{\Mapleunderset{n =1}{\sum }}a _{n }\varphi _{n }\left(x \right)\varphi _{m }\left(x \right)\mathop{\rm  }d x =$}
\mapleinline{inert}{2d}{Typesetting:-mrow(Typesetting:-mo("=", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-maction(Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mtable(Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("a", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mi("m", family = "Times", italic = "true", mathvariant = "italic")), subscriptshift = "0"), Typesetting:-mi("C", family = "Times", italic = "false", mathvariant = "normal")), Typesetting:-mrow(Typesetting:-mi("m", family = "Times", italic = "true", mathvariant = "italic")), subscriptshift = "0"), Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mi("at", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mi("m", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mo("=", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-mi("n", family = "Times", italic = "true", mathvariant = "italic")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("0", family = "Times", mathvariant = "normal"), Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mi("at", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mi("m", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mo("&NotEqual;", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-mi("n", family = "Times", italic = "true", mathvariant = "italic")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), align = "axis", rowalign = "baseline", columnalign = "center", groupalign = "{left}", alignmentscope = "true", columnwidth = "auto", width = "auto", rowspacing = "1.0ex", columnspacing = "0.8em", rowlines = "none", columnlines = "none", frame = "none", framespacing = "0.4em 0.5ex", equalrows = "false", equalcolumns = "false", displaystyle = "false", side = "right", minlabelspacing = "0.8em"), Typesetting:-mi("")), family = "Times", mathvariant = "normal", Typesetting:-msemantics = "ColVector", open = "[", close = "]", Typesetting:-msemantics = "ColVector"), actiontype = "rtableaddress"), Typesetting:-mi("")), Typesetting:-mi(""))}{$\displaystyle =$}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
となる．こうして，係数\mapleinline{inert}{2d}{a[n]}{$\displaystyle a_{{n}}$}
が}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{a[n] = (int(F(x)*`&varphi;`[n](x), x = a .. b))/C[n]}{\[\displaystyle a_{{n}}={\frac {\int _{a}^{b}\!F \left( x \right) \varphi _{{n}} \left( x \right) {dx}}{C_{{n}}}}\]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
で決定できる．}\end{Maple Normal}
\end{maplelatex}
\subsubsection{\textbf{対象とする関数}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{restart;
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{#F:=x->piecewise(x=0,1/2,x>0,x);
#F:=x->piecewise(x<1/2,x,x>=1/2,1-x);
#F:=x->piecewise(x<1/2,-1,x>1/2,1);
F:=x->piecewise(x<1/2,-1,x>=1/2,1);
#F:=x->piecewise(x>0 and x<1/2,-1,x>1/2,1);
#F:=x->x-1/2;
plot(F(x),x=0..1);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{F := proc (x) options operator, arrow; piecewise(x < 1/2, -1, 1/2 <= x, 1) end proc}{\[\displaystyle F\, := \,x\mapsto \cases{-1&$x<1/2$\cr 1&$1/2\leq x$\cr}\]}
\end{maplelatex}
\mapleresult
\mapleplot{C10_FFTplot2d11.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{KK:=3;
N:=2\symbol{94}KK;L:=1-0;
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{KK := 3}{\[\displaystyle {\it KK}\, := \,3\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{N := 8}{\[\displaystyle N\, := \,8\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{L := 1}{\[\displaystyle L\, := \,1\]}
\end{maplelatex}
\end{maplegroup}
\subsubsection{\textbf{\textit{直接積分によるフーリエ級数}}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{2*Pi*1/L*x;
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{2*Pi*x}{\[\displaystyle 2\,\pi \,x\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{int(F(x)*cos(2*Pi*1/L*x),x=0..L);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{0}{\[\displaystyle 0\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{for n from 0 to N do
a[n]:=2/L*int(F(x)*cos(2*Pi*n/L*x),x=0..L);
end do;
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{a[0] := 0}{\[\displaystyle a_{{0}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{a[1] := 0}{\[\displaystyle a_{{1}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{a[2] := 0}{\[\displaystyle a_{{2}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{a[3] := 0}{\[\displaystyle a_{{3}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{a[4] := 0}{\[\displaystyle a_{{4}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{a[5] := 0}{\[\displaystyle a_{{5}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{a[6] := 0}{\[\displaystyle a_{{6}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{a[7] := 0}{\[\displaystyle a_{{7}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{a[8] := 0}{\[\displaystyle a_{{8}}\, := \,0\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{for n from 0 to N do
b[n]:=2/L*int(F(x)*sin(2*Pi*n/L*x),x=0..L);
end do;
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{b[0] := 0}{\[\displaystyle b_{{0}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{b[1] := -4/Pi}{\[\displaystyle b_{{1}}\, := \,-4\,{\pi }^{-1}\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{b[2] := 0}{\[\displaystyle b_{{2}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{b[3] := -4/(3*Pi)}{\[\displaystyle b_{{3}}\, := \,-4/3\,{\pi }^{-1}\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{b[4] := 0}{\[\displaystyle b_{{4}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{b[5] := -4/(5*Pi)}{\[\displaystyle b_{{5}}\, := \,-4/5\,{\pi }^{-1}\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{b[6] := 0}{\[\displaystyle b_{{6}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{b[7] := -4/(7*Pi)}{\[\displaystyle b_{{7}}\, := \,-4/7\,{\pi }^{-1}\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{b[8] := 0}{\[\displaystyle b_{{8}}\, := \,0\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{for n from 0 to N do
  c[n]:=1/L*int(F(x)*exp(-I*2*Pi*n/L*x),x=0..L);
end do;
for n from 1 to N do
  c[-n]:=1/L*int(F(x)*exp(I*2*Pi*n/L*x),x=0..L);
end do;
\begin{Maple Normal}{
Note that:
a[n]=c[n]+c[-n], b[n]=I (c[n]-c[-n])
c[-n]= 1/2 (a[n] +  b[n]), c[n]=1/2 (a[n] - I b[n])}\end{Maple Normal}
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[0] := 0}{\[\displaystyle c_{{0}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[1] := (2*I)/Pi}{\[\displaystyle c_{{1}}\, := \,{\frac {2\,i}{\pi }}\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[2] := 0}{\[\displaystyle c_{{2}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[3] := (2/3*I)/Pi}{\[\displaystyle c_{{3}}\, := \,{\frac {2/3\,i}{\pi }}\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[4] := 0}{\[\displaystyle c_{{4}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[5] := (2/5*I)/Pi}{\[\displaystyle c_{{5}}\, := \,{\frac {2/5\,i}{\pi }}\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[6] := 0}{\[\displaystyle c_{{6}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[7] := (2/7*I)/Pi}{\[\displaystyle c_{{7}}\, := \,{\frac {2/7\,i}{\pi }}\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[8] := 0}{\[\displaystyle c_{{8}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[-1] := -(2*I)/Pi}{\[\displaystyle c_{{-1}}\, := \,{\frac {-2\,i}{\pi }}\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[-2] := 0}{\[\displaystyle c_{{-2}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[-3] := -(2/3*I)/Pi}{\[\displaystyle c_{{-3}}\, := \,{\frac {-2/3\,i}{\pi }}\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[-4] := 0}{\[\displaystyle c_{{-4}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[-5] := -(2/5*I)/Pi}{\[\displaystyle c_{{-5}}\, := \,{\frac {-2/5\,i}{\pi }}\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[-6] := 0}{\[\displaystyle c_{{-6}}\, := \,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[-7] := -(2/7*I)/Pi}{\[\displaystyle c_{{-7}}\, := \,{\frac {-2/7\,i}{\pi }}\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[-8] := 0}{\[\displaystyle c_{{-8}}\, := \,0\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{F1:=unapply(sum(evalf(c[i]*exp(I*2*Pi*i/L*x)),i=-(N-1)..(N-1)),x):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{plot(\{Re(F1(x)),F(x)\},x=0..1);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{C10_FFTplot2d12.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{evalf(2/3/Pi);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{.2122065907}{\[\displaystyle  0.2122065907\]}
\end{maplelatex}
\end{maplegroup}
\subsection{\textbf{選点直交性による計算の簡素化}}
\begin{maplelatex}\begin{Maple Normal}{
ところが，実際に積分していては，時間がかかりすぎる．直交関数系の選点直交性を使うとより簡単になる．}\end{Maple Normal}
\end{maplelatex}
\subsubsection{直交関数系の選点直交性}
\begin{maplelatex}\begin{Maple Normal}{
直交多項式は，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{`&varphi;`[n](x) = (0*at)*x and (0*at)*x = x[1], x[2], `&ctdot;`(x[n])}{\[\displaystyle \varphi _{{n}} \left( x \right) =0{\rm \: \wedge \:}0=x_{{1}},\,x_{{2}},\,\mbox {{\tt `\&ctdot;`}} \left( x_{{n}} \right) \]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
である．\mapleinline{inert}{2d}{n-1}{$\displaystyle n-1$}
以下の次数\mapleinline{inert}{2d}{m, l}{$\displaystyle m,\,l$}
では，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{sum(phi[l](x[i])*`&varphi;`[m](x[i]), i = 1 .. n) = delta[ml]*C[l]}{\[\displaystyle \sum _{i=1}^{n}\phi_{{l}} \left( x_{{i}} \right) \varphi _{{m}} \left( x_{{i}} \right) =\delta_{{{\it ml}}}C_{{l}}\]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
が成り立つ．これは，直交関係と違い積分でないことに注意．証明は略．}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
これを使えば，この先程の直交関数展開}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{F(x) = sum(a[l]*`&varphi;`[l](x), l = 1 .. N)}{\[\displaystyle F \left( x \right) =\sum _{l=1}^{N}a_{{l}}\varphi _{{l}} \left( x \right) \]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
の両辺に\mapleinline{inert}{2d}{`&varphi;`[m](x[i])}{$\displaystyle \varphi _{{m}} \left( x_{{i}} \right) $}
を掛けて\mapleinline{inert}{2d}{i}{$\displaystyle i$}
について和をとれば，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{Typesetting:-mrow(Typesetting:-munderover(Typesetting:-mo("&Sum;", family = "Times", mathvariant = "normal", fence = "unset", separator = "unset", stretchy = "true", symmetric = "unset", largeop = "true", movablelimits = "true", accent = "unset", lspace = "0.0em", rspace = "0.1666667em"), Typesetting:-mrow(Typesetting:-mi("i", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mo("=", family = "Times", mathvariant = "normal", fence = "unset", separator = "unset", stretchy = "unset", symmetric = "unset", largeop = "unset", movablelimits = "unset", accent = "unset", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-mn("1", family = "Times", mathvariant = "normal")), Typesetting:-mrow(Typesetting:-mi("n", family = "Times", italic = "true", mathvariant = "italic")), accent = "false", accentunder = "false"), Typesetting:-mi("F", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mi("i", family = "Times", italic = "true", mathvariant = "italic")), subscriptshift = "0")), family = "Times", mathvariant = "normal"), Typesetting:-msub(Typesetting:-mi("&phi;", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mi("m", family = "Times", italic = "true", mathvariant = "italic")), subscriptshift = "0"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mi("i", family = "Times", italic = "true", mathvariant = "italic")), subscriptshift = "0")), family = "Times", mathvariant = "normal"), Typesetting:-mo("=", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"))}{$\displaystyle \Mapleoverset{n }{\Mapleunderset{i =1}{\sum }}F \left(x _{i }\right)\phi _{m }\left(x _{i }\right)=$}
\mapleinline{inert}{2d}{sum(sum(a[l]*`&varphi;`[l](x[i])*`&varphi;`[m](x[i]), l = 1 .. N), i = 1 .. n)}{$\displaystyle \sum _{i=1}^{n} \left( \sum _{l=1}^{N}a_{{l}}\varphi _{{l}} \left( x_{{i}} \right) \varphi _{{m}} \left( x_{{i}} \right)  \right) $}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
=\mapleinline{inert}{2d}{sum(a[l]*(sum(`&varphi;`[l](x[i])*`&varphi;`[m](x[i]), i = 1 .. n)), l = 1 .. N)}{$\displaystyle \sum _{l=1}^{N} \left( a_{{l}}\sum _{i=1}^{n}\varphi _{{l}} \left( x_{{i}} \right) \varphi _{{m}} \left( x_{{i}} \right)  \right) $}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
=\mapleinline{inert}{2d}{sum(a[l]*delta[ml]*C[m], l = 1 .. N) = a[m]*C[m]}{$\displaystyle \sum _{l=1}^{N}a_{{l}}\delta_{{{\it ml}}}C_{{m}}=a_{{m}}C_{{m}}$}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
となる．つまり，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{a[m] = (sum(F(x[i])*`&varphi;`[m](x[i]), i = 1 .. n))/C[m]}{\[\displaystyle a_{{m}}={\frac {\sum _{i=1}^{n}F \left( x_{{i}} \right) \varphi _{{m}} \left( x_{{i}} \right) }{C_{{m}}}}\]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
となり，単純な関数の代入とかけ算で係数が決定される．}\end{Maple Normal}
\end{maplelatex}
\subsubsection{\textbf{選点直交性を用いた結果}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{KK:=4;
N:=2\symbol{94}KK;L:=1-0;
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{KK := 4}{\[\displaystyle {\it KK}\, := \,4\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{N := 16}{\[\displaystyle N\, := \,16\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{L := 1}{\[\displaystyle L\, := \,1\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{for k from 0 to N-1 do
c[k]:=evalf(sum(F(i*L/N)*exp(-I*2*Pi*k*i/N),i=0..N-1));
end do;
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[0] := 0.}{\[\displaystyle c_{{0}}\, := \, 0.0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[1] := -2.000000000+10.05467898*I}{\[\displaystyle c_{{1}}\, := \,- 2.0+ 10.05467898\,i\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[2] := 0.}{\[\displaystyle c_{{2}}\, := \, 0.0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[3] := -2.000000000+2.993211524*I}{\[\displaystyle c_{{3}}\, := \,- 2.0+ 2.993211524\,i\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[4] := 0.}{\[\displaystyle c_{{4}}\, := \, 0.0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[5] := -2.000000001+1.336357276*I}{\[\displaystyle c_{{5}}\, := \,- 2.000000001+ 1.336357276\,i\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[6] := 0.}{\[\displaystyle c_{{6}}\, := \, 0.0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[7] := -2.000000001+.3978247331*I}{\[\displaystyle c_{{7}}\, := \,- 2.000000001+ 0.3978247331\,i\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[8] := 0.}{\[\displaystyle c_{{8}}\, := \, 0.0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[9] := -2.000000001-.3978247331*I}{\[\displaystyle c_{{9}}\, := \,- 2.000000001- 0.3978247331\,i\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[10] := 0.}{\[\displaystyle c_{{10}}\, := \, 0.0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[11] := -2.000000001-1.336357276*I}{\[\displaystyle c_{{11}}\, := \,- 2.000000001- 1.336357276\,i\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[12] := 0.}{\[\displaystyle c_{{12}}\, := \, 0.0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[13] := -2.000000000-2.993211524*I}{\[\displaystyle c_{{13}}\, := \,- 2.0- 2.993211524\,i\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[14] := 0.}{\[\displaystyle c_{{14}}\, := \, 0.0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{c[15] := -2.000000000-10.05467898*I}{\[\displaystyle c_{{15}}\, := \,- 2.0- 10.05467898\,i\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{F1:=unapply(sum(evalf(c[i]*exp(I*2*Pi*i/L*x)/N),i=0..(N/2-1))+
sum(evalf(c[N-i]*exp(-I*2*Pi*i/L*x)/N),i=1..(N/2-1)),x):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{plot(\{Re(F1(x)),F(x)\},x=0..1);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{C10_FFTplot2d13.eps}
\end{maplegroup}
\subsection{\textbf{高速フーリエ変換アルゴリズムによる高速化}}
\begin{maplelatex}\begin{Maple Normal}{
\mapleinline{inert}{2d}{sin, cos}{$\displaystyle \sin,\,\cos$}
と\mapleinline{inert}{2d}{exp}{$\displaystyle \exp$}
関数を結びつけるオイラーの関係を使うと，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{exp(2*Pi/N*I) = cos(2*Pi/N)+I*sin(2*Pi/N)}{\[\displaystyle {{\rm e}^{{\frac {2\,i\pi }{N}}}}=\cos \left( 2\,{\frac {\pi }{N}} \right) +i\sin \left( 2\,{\frac {\pi }{N}} \right) \]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
と変換できる．これを使うと，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{c[k] = (sum(F(x[i])*exp(-2*`&pi;i`/N*I), i = 0 .. N-1))/C[m]}{\[\displaystyle c_{{k}}=\sum _{i=0}^{N-1}F \left( x_{{i}} \right) {{\rm e}^{{\frac {-2\,i\pi i}{N}}}}{C_{{m}}}^{-1}\]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
となる．\mapleinline{inert}{2d}{N = 8}{$\displaystyle N=8$}
の場合を実際に計算すると，\mapleinline{inert}{2d}{z = exp(-I*(2*Pi*(1/8)))}{$\displaystyle z={{\rm e}^{-1/4\,i\pi }}$}
として，\mapleinline{inert}{2d}{Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("8", family = "Times", mathvariant = "normal")), superscriptshift = "0"), Typesetting:-mo("=", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-mn("1", family = "Times", mathvariant = "normal"), Typesetting:-mo(",", family = "Times", mathvariant = "normal", fence = "false", separator = "true", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.3333333em"), Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("9", family = "Times", mathvariant = "normal")), superscriptshift = "0"), Typesetting:-mo("=", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-mi("z", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mo("&ctdot;", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"))}{$\displaystyle z ^{8}=1,\mathop{\rm  }z ^{9}=z \mathop{\rm  }\esctdot $}
を使うと，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
\mapleinline{inert}{2d}{Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-maction(Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mtable(Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("c", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("0", family = "Times", mathvariant = "normal")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("c", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("c", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("2", family = "Times", mathvariant = "normal")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("c", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("3", family = "Times", mathvariant = "normal")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("c", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("4", family = "Times", mathvariant = "normal")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("c", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("5", family = "Times", mathvariant = "normal")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("c", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("6", family = "Times", mathvariant = "normal")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("c", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("7", family = "Times", mathvariant = "normal")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), align = "axis", rowalign = "baseline", columnalign = "center", groupalign = "{left}", alignmentscope = "true", columnwidth = "auto", width = "auto", rowspacing = "1.0ex", columnspacing = "0.8em", rowlines = "none", columnlines = "none", frame = "none", framespacing = "0.4em 0.5ex", equalrows = "false", equalcolumns = "false", displaystyle = "false", side = "right", minlabelspacing = "0.8em"), Typesetting:-mi("")), family = "Times", mathvariant = "normal", Typesetting:-msemantics = "ColVector", open = "[", close = "]", Typesetting:-msemantics = "ColVector"), actiontype = "rtableaddress"), Typesetting:-mo("=", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-maction(Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mtable(Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("2", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("3", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("4", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("5", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("6", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("7", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("2", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("4", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("6", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("2", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("4", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("6", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("3", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("6", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("4", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("7", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("2", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("5", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("4", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("4", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("4", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("4", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("5", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("2", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("7", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("4", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("6", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("z", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("2", family = "Times", mathvariant = "normal")), superscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), align = "axis", rowalign = "baseline", columnalign = "center", groupalign = "{left}", alignmentscope = "true", columnwidth = "auto", width = "auto", rowspacing = "1.0ex", columnspacing = "0.8em", rowlines = "none", columnlines = "none", frame = "none", framespacing = "0.4em 0.5ex", equalrows = "false", equalcolumns = "false", displaystyle = "false", side = "right", minlabelspacing = "0.8em"), Typesetting:-mi("")), family = "Times", mathvariant = "normal", Typesetting:-msemantics = "Matrix", open = "[", close = "]", Typesetting:-msemantics = "Matrix"), actiontype = "rtableaddress"), Typesetting:-mi("")), Typesetting:-mi(""), Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-maction(Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mtable(Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("F", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("0", family = "Times", mathvariant = "normal")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("F", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("1", family = "Times", italic = "true", mathvariant = "italic")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("F", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("2", family = "Times", mathvariant = "normal")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("F", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("3", family = "Times", mathvariant = "normal")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("F", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("4", family = "Times", mathvariant = "normal")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("F", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("5", family = "Times", mathvariant = "normal")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("F", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("6", family = "Times", italic = "true", mathvariant = "italic")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("F", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("7", family = "Times", italic = "true", mathvariant = "italic")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), align = "axis", rowalign = "baseline", columnalign = "center", groupalign = "{left}", alignmentscope = "true", columnwidth = "auto", width = "auto", rowspacing = "1.0ex", columnspacing = "0.8em", rowlines = "none", columnlines = "none", frame = "none", framespacing = "0.4em 0.5ex", equalrows = "false", equalcolumns = "false", displaystyle = "false", side = "right", minlabelspacing = "0.8em"), Typesetting:-mi("")), family = "Times", mathvariant = "normal", Typesetting:-msemantics = "ColVector", open = "[", close = "]", Typesetting:-msemantics = "ColVector"), actiontype = "rtableaddress"), Typesetting:-mi("")), Typesetting:-mi(""))}{$\displaystyle =$}
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
となる．この行列計算を素直に実行すると，8×8=64回の演算が必要となる．これを減らせないかと考えたのが，高速フーリエ変換の始まりである．}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
この行列をよく見ると同じ計算を重複しておこなっていることが分かる．そこで，行列の左側と右側で同じ計算をしている部分をまとめると，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
\mapleinline{inert}{2d}{Vector[column](%id = 4501132360) = Typesetting:-delayDotProduct(Matrix(%id = 4524548416), Vector[column](%id = 4481488248), true)}{\[\displaystyle  \left[ \begin {array}{c} c_{{0}}\\ \noalign{\medskip}c_{{1}}\\ \noalign{\medskip}c_{{2}}\\ \noalign{\medskip}c_{{3}}\\ \noalign{\medskip}c_{{4}}\\ \noalign{\medskip}c_{{5}}\\ \noalign{\medskip}c_{{6}}\\ \noalign{\medskip}c_{{7}}\end {array} \right] ={\it delayDotProduct} \left(  \left[ \begin {array}{cccccccc} 1&1&1&1&0&0&0&0\\ \noalign{\medskip}0&0&0&0&1&z&{z}^{2}&{z}^{3}\\ \noalign{\medskip}1&{z}^{2}&{z}^{4}&{z}^{6}&0&0&0&0\\ \noalign{\medskip}0&0&0&0&1&{z}^{3}&{z}^{6}&z\\ \noalign{\medskip}1&{z}^{4}&1&{z}^{4}&0&0&0&0\\ \noalign{\medskip}0&0&0&0&1&{z}^{5}&{z}^{2}&{z}^{7}\\ \noalign{\medskip}1&{z}^{6}&{z}^{4}&{z}^{2}&0&0&0&0\\ \noalign{\medskip}0&0&0&0&1&{z}^{7}&{z}^{6}&{z}^{5}\end {array} \right] , \left[ \begin {array}{c} F_{{0}}+F_{{4}}\\ \noalign{\medskip}F_{{1}}+F_{{5}}\\ \noalign{\medskip}F_{{2}}+F_{{6}}\\ \noalign{\medskip}F_{{3}}+F_{{7}}\\ \noalign{\medskip}F_{{0}}-F_{{4}}\\ \noalign{\medskip}F_{{1}}-F_{{5}}\\ \noalign{\medskip}\mbox {{\tt `\#msub(mi("F"),mrow(mo("`}}\mbox {{\tt `?`}}\mbox {{\tt `"),mo("`}}\mbox {{\tt `?`}}\mbox {{\tt `")))`}}-F_{{6}}\\ \noalign{\medskip}\mbox {{\tt `\#msub(mi("F"),mrow(mo("`}}\mbox {{\tt `?`}}\mbox {{\tt `"),mo("`}}\mbox {{\tt `?`}}\mbox {{\tt `")))`}}-F_{{7}}\end {array} \right] \\
\mbox{},{\it true} \right) \]}
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
とすることができる．ここで，\mapleinline{inert}{2d}{z^4 = -1}{$\displaystyle {z}^{4}=-1$}
などを使っている．右側のベクトルの計算でロスするが，行列の中の計算の回数を半分に減らすことができる．再度できあがった行列を見れば，同じ計算をさらにまとめることができそうである．こうして，次々と計算回数を減らしていくことが可能で，最終的に行列部分の計算が一切なくなる．残るのは，右側のベクトルの足し算引き算だけになる．}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
このベクトルの組み合わせは，一見相当複雑そうで，その条件分岐で時間がかかりそうに思われる．しかし，よく調べてみれば，単純なビット演算で処理することが可能であることが判明した．こうして，2の整数乗のデータの組に対しては，極めて高速にフーリエ変換を実行することが可能となった．}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
FFTでの演算回数は，データ数を\mapleinline{inert}{2d}{N}{$\displaystyle N$}
とすると}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{N*log[2]*N}{\[\displaystyle {N}^{2}{\it log}_{{2}}\]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
となる．単純な場合の\mapleinline{inert}{2d}{N^2}{$\displaystyle {N}^{2}$}
と比較すると，以下のようになり，どれだけ高速化されているかが理解されよう．}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{dN2:=[];
dFft:=[];
for i from 2 to 16 do
N:=2\symbol{94}i;
n2:=N*N;
Fft:=N/2*log[2](N);
Fft/n2;
printf("%10d %12d %12d %10.5f\symbol{92}n",N,n2,Fft,evalf(Fft/n2));
dN2:=[op(dN2),[N,n2]];
dFft:=[op(dFft),[N,Fft]];
end do:
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{dN2 := []}{\[\displaystyle {\it dN2}\, := \,[]\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{dFft := []}{\[\displaystyle {\it dFft}\, := \,[]\]}
\end{maplelatex}
\mapleresult
4           16            4    0.250008           64           12    0.1875016          256           32    0.1250032         1024           80    0.0781264         4096          192    0.04688128        16384          448    0.02734256        65536         1024    0.01562512       262144         2304    0.008791024      1048576         5120    0.004882048      4194304        11264    0.002694096     16777216        24576    0.00146
8192     67108864        53248    0.0007916384    268435456       114688    0.0004332768   1073741824       245760    0.0002365536   4294967296       524288    0.00012\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{with(plots):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{l1:=plot(dN2):
l2:=plot(dFft):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{display(l1,l2);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{C10_FFTplot2d14.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{l1:=logplot(dN2):
l2:=logplot(dFft):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{display(l1,l2);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{C10_FFTplot2d15.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{l1:=loglogplot(dN2):
l2:=loglogplot(dFft):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{display(l1,l2);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{C10_FFTplot2d16.eps}
\end{maplegroup}
\subsubsection{\textbf{FFT関数を用いた結果}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{KK:=4;
N:=2\symbol{94}KK;i:='i';L:=1-0;
x1:=array([evalf(seq(F(i/N),i=0..N-1))]);
y1:=array([evalf(seq(0,i=0..N-1))]);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{KK := 4}{\[\displaystyle {\it KK}\, := \,4\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{N := 16}{\[\displaystyle N\, := \,16\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{i := i}{\[\displaystyle i\, := \,i\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{L := 1}{\[\displaystyle L\, := \,1\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{x1 := Vector[row](%id = 4498496496)}{\[\displaystyle {\it x1}\, := \, \left[ \begin {array}{cccccccccccccccc} - 1.0&- 1.0&- 1.0&- 1.0&- 1.0&- 1.0&- 1.0&- 1.0& 1.0& 1.0& 1.0& 1.0& 1.0& 1.0& 1.0& 1.0\end {array} \right] \]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{y1 := Vector[row](%id = 4499550704)}{\[\displaystyle {\it y1}\, := \, \left[ \begin {array}{cccccccccccccccc}  0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0& 0.0\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{FFT(KK,x1,y1);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{16}{\[\displaystyle 16\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{interface(displayprecision=2):
print(x1);print(y1);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{Vector[row](%id = 4490538512)}{\[\displaystyle  \left[ \begin {array}{cccccccccccccccc}  0.0&- 2.0& 0.0&- 2.0& 0.0&- 2.0& 0.0&- 2.0& 0.0&- 2.0& 0.0&- 2.0& 0.0&- 2.0& 0.0&- 2.0\end {array} \right] \]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{Vector[row](%id = 4511228496)}{\[\displaystyle  \left[ \begin {array}{cccccccccccccccc}  0.0& 10.05& 0.0& 2.99& 0.0& 1.34& 0.0& 0.40& 0.0&- 0.40& 0.0&- 1.34& 0.0&- 2.99& 0.0&- 10.05\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{F2:=unapply(sum(evalf((x1[i]+I*y1[i])*exp(I*2*Pi*(i-1)/L*x)/N),i=1..N/2)+
sum(evalf((x1[N-i+2]+I*y1[N-i+2])*exp(-I*2*Pi*(i-1)/L*x)/N),i=2..N/2),x):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{plot(\{Re(F2(x)),F(x)\},x=0..1);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{C10_FFTplot2d17.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{}{}
\end{mapleinput}
\end{maplegroup}
\end{document}
