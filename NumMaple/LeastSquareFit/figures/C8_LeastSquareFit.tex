%% Created by Maple 15.01, Mac OS X
%% Source Worksheet: C8_LeastSquareFit.mw
%% Generated: Wed Aug 15 12:15:57 JST 2012
\documentclass{article}
\usepackage{maplestd2e}
\def\emptyline{\vspace{12pt}}
\begin{document}
\pagestyle{empty}
\DefineParaStyle{Maple Heading 1}
\DefineParaStyle{Maple Text Output}
\DefineParaStyle{Maple Dash Item}
\DefineParaStyle{Maple Bullet Item}
\DefineParaStyle{Maple Normal}
\DefineParaStyle{Maple Heading 4}
\DefineParaStyle{Maple Heading 3}
\DefineParaStyle{Maple Heading 2}
\DefineParaStyle{Maple Warning}
\DefineParaStyle{Maple Title}
\DefineParaStyle{Maple Error}
\DefineCharStyle{Maple Hyperlink}
\DefineCharStyle{Maple 2D Math}
\DefineCharStyle{Maple Maple Input}
\DefineCharStyle{Maple 2D Output}
\DefineCharStyle{Maple 2D Input}
\section{\begin{center}
\textbf{線形最小2乗法}\end{center}
}
\begin{maplelatex}\begin{center}
ー数値計算(11/12/2)ー\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{center}
関西学院大学理工学部 西谷滋人\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{flushright}
Copyright @2007-11 by Shigeto R. Nishitani\end{flushright}
\end{maplelatex}
\section{\textbf{最乗2乗法の原理}}
\begin{maplelatex}\begin{Maple Normal}{
前回の授業では，データに多項式を完全にフィットする補間についてみた．今回は，近似的にフィットする最小二乗法について詳しくみていく．図のようなデータに直線をフィットする場合を考えよう．}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
近似の模式図}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
\mapleplot{C8_LeastSquareFitplot2d1.eps}
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\subsection{\textbf{コマンドleastsquareによるfitting(2変数の例)}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{restart:
X:=[1,2,3,4]:
Y:=[0,5,15,24]:
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{with(plots):with(linalg):with(stats):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{l1:=pointplot(transpose([X,Y]),symbolsize=30):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{eq_fit:=fit[leastsquare[[x, y], y = a0+a1*x, \{a0,a1\}]]([X, Y]);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{eq_fit := y = -19/2+(41/5)*x}{\[\displaystyle {\it eq\_fit}\, := \,y=-19/2+{\frac {41}{5}}\,x\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{f1:=unapply(rhs(eq_fit),x);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{f1 := proc (x) options operator, arrow; -19/2+(41/5)*x end proc}{\[\displaystyle {\it f1}\, := \,x\mapsto -19/2+{\frac {41}{5}}\,x\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{p1:=plot(f1(x),x=0..4):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{display(p1,l1);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{C8_LeastSquareFitplot2d2.eps}
\end{maplegroup}
\subsection{\textbf{最小2乗法の原理}}
\begin{maplelatex}\begin{Maple Normal}{
もっとも簡単な例で原理を解説する．近似関数として，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{F(x) = a[0]+a[1]*x}{\[\displaystyle F \left( x \right) =a_{{0}}+a_{{1}}x\]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
という直線近似を考える．もっともらしい関数は\mapleinline{inert}{2d}{N}{$\displaystyle N$}
点の測定データとの差\mapleinline{inert}{2d}{d[i] = F(x[i])-y[i]}{$\displaystyle d_{{i}}=F \left( x_{{i}} \right) -y_{{i}}$}
を最小にすればよさそうであるが，これはプラスマイナスですぐに消えて不定になる．そこで，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("&chi;", family = "Times New Roman", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("2", family = "Times New Roman", mathvariant = "normal")), superscriptshift = "0"), Typesetting:-mo("=", family = "Times New Roman", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-munderover(Typesetting:-mrow(Typesetting:-mo("&Sum;", family = "Times New Roman", mathvariant = "normal", fence = "false", separator = "false", stretchy = "true", symmetric = "false", largeop = "true", movablelimits = "true", accent = "false", lspace = "0.0em", rspace = "0.1666667em")), Typesetting:-mrow(Typesetting:-mi("i", family = "Times New Roman", italic = "true", mathvariant = "italic")), Typesetting:-mrow(Typesetting:-mi("N", family = "Times New Roman", italic = "true", mathvariant = "italic")), accent = "false", accentunder = "false"), Typesetting:-msubsup(Typesetting:-mi("d", family = "Times New Roman", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mi("i", family = "Times New Roman", italic = "true", mathvariant = "italic")), Typesetting:-mrow(Typesetting:-mn("2", family = "Times New Roman", mathvariant = "normal")), superscriptshift = "0", subscriptshift = "0", Typesetting:-msemantics = "[none,none]"), Typesetting:-mo("=", family = "Times New Roman", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-munderover(Typesetting:-mo("&Sum;", family = "Times New Roman", mathvariant = "normal", fence = "unset", separator = "unset", stretchy = "true", symmetric = "unset", largeop = "true", movablelimits = "true", accent = "unset", lspace = "0.0em", rspace = "0.1666667em"), Typesetting:-mrow(Typesetting:-mi("i", family = "Times New Roman", italic = "true", mathvariant = "italic")), Typesetting:-mrow(Typesetting:-mi("N", family = "Times New Roman", italic = "true", mathvariant = "italic")), accent = "false", accentunder = "false"), Typesetting:-msup(Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("a", family = "Times New Roman", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("0", family = "Times New Roman", mathvariant = "normal")), subscriptshift = "0"), Typesetting:-mo("+", family = "Times New Roman", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2222222em", rspace = "0.2222222em"), Typesetting:-msub(Typesetting:-mi("a", family = "Times New Roman", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("1", family = "Times New Roman", mathvariant = "normal")), subscriptshift = "0"), Typesetting:-msub(Typesetting:-mi("x", family = "Times New Roman", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mi("i", family = "Times New Roman", italic = "true", mathvariant = "italic")), subscriptshift = "0"), Typesetting:-mo("&minus;", family = "Times New Roman", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2222222em", rspace = "0.2222222em"), Typesetting:-msub(Typesetting:-mi("y", family = "Times New Roman", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mi("i", family = "Times New Roman", italic = "true", mathvariant = "italic")), subscriptshift = "0")), family = "Times New Roman", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("2", family = "Times New Roman", mathvariant = "normal")), superscriptshift = "0"))}{\[\displaystyle \chi ^{2}=\Mapleoverset{N }{\Mapleunderset{i }{\sum }}d _{i }^{2}=\Mapleoverset{N }{\Mapleunderset{i }{\sum }}\left(a _{0}+a _{1}x _{i }-y _{i }\right)^{2}\]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
という関数を考える．この\mapleinline{inert}{2d}{chi^2}{$\displaystyle {\chi}^{2}$}
(カイ二乗)関数が，\mapleinline{inert}{2d}{a[0], a[1]}{$\displaystyle a_{{0}},\,a_{{1}}$}
をパラメータとして変えた時に最小となる\mapleinline{inert}{2d}{a[0], a[1]}{$\displaystyle a_{{0}},\,a_{{1}}$}
を求める．これは，それらの微分がそれぞれ0となる場合である．これは\mapleinline{inert}{2d}{chi^2}{$\displaystyle {\chi}^{2}$}
の和\mapleinline{inert}{2d}{Typesetting:-mo("&Sum;", family = "Times New Roman", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")}{$\displaystyle \sum $}
(sum)の中身を展開し，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
\mapleinline{inert}{2d}{Typesetting:-mrow(Typesetting:-msup(Typesetting:-mi("&chi;", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("2", mathvariant = "normal")), superscriptshift = "0"), Typesetting:-mo("=", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"))}{\[\displaystyle \chi ^{2}=\]}
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
\mapleinline{inert}{2d}{a[0], a[1]}{$\displaystyle a_{{0}},\,a_{{1}}$}
でそれぞれ微分すれば}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
\mapleinline{inert}{2d}{Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mfrac(Typesetting:-mo("&PartialD;", family = "Times", mathvariant = "normal", fence = "unset", separator = "unset", stretchy = "unset", symmetric = "unset", largeop = "unset", movablelimits = "unset", accent = "unset", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mrow(Typesetting:-mo("&PartialD;", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-msub(Typesetting:-mi("a", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("0", family = "Times", mathvariant = "normal")), subscriptshift = "0")), linethickness = "1", denomalign = "center", numalign = "center", bevelled = "false"), Typesetting:-mo("&ApplyFunction;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mspace(height = "0.0ex", width = "0.4em", depth = "0.0ex", linebreak = "auto"), Typesetting:-msup(Typesetting:-mi("&chi;", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("2", family = "Times", mathvariant = "normal")), superscriptshift = "0"), Typesetting:-mi("")), Typesetting:-mo("=", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"))}{\[\displaystyle \frac{\partial }{\partial \mathop{\rm  }a _{0}}\chi ^{2}=\]}
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
\mapleinline{inert}{2d}{}{\[\displaystyle \]}
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
\mapleinline{inert}{2d}{Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mfrac(Typesetting:-mo("&PartialD;", family = "Times", mathvariant = "normal", fence = "unset", separator = "unset", stretchy = "unset", symmetric = "unset", largeop = "unset", movablelimits = "unset", accent = "unset", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mrow(Typesetting:-mo("&PartialD;", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mo(" ", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-msub(Typesetting:-mi("a", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), subscriptshift = "0")), linethickness = "1", denomalign = "center", numalign = "center", bevelled = "false"), Typesetting:-mo("&ApplyFunction;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mspace(height = "0.0ex", width = "0.4em", depth = "0.0ex", linebreak = "auto"), Typesetting:-msup(Typesetting:-mi("&chi;", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mrow(Typesetting:-mn("2", family = "Times", mathvariant = "normal")), superscriptshift = "0"), Typesetting:-mi("")), Typesetting:-mo("=", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"))}{\[\displaystyle \frac{\partial }{\partial \mathop{\rm  }a _{1}}\chi ^{2}=\]}
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
という\mapleinline{inert}{2d}{a[0], a[1]}{$\displaystyle a_{{0}},\,a_{{1}}$}
を未知変数とする2元の連立方程式が得られる．これは前に説明した通り逆行列で解くことができる．}\end{Maple Normal}
\end{maplelatex}
\subsection{\textbf{χ2乗の極小値から(2変数の例)}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{restart;
X:=[1,2,3,4]:
Y:=[0,5,15,24]:
f1:=x->a0+a1*x:
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{S:=0;
for i from 1 to 4 do
  S:=S+(f1(X[i])-Y[i])\symbol{94}2;
end do:
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{S := 0}{\[\displaystyle S\, := \,0\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{fS:=unapply(S,(a0,a1));
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{fS := proc (a0, a1) options operator, arrow; (a0+a1)^2+(a0+2*a1-5)^2+(a0+3*a1-15)^2+(a0+4*a1-24)^2 end proc}{\[\displaystyle {\it fS}\, := \,( {{\it a0},{\it a1}} )\mapsto  \left( {\it a0}+{\it a1} \right) ^{2}+ \left( {\it a0}+2\,{\it a1}-5 \right) ^{2}+ \left( {\it a0}+3\,{\it a1}-15 \right) ^{2}+ \left( {\it a0}+4\,{\it a1}-24 \right) ^{2}\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{expand(fS(a0,a1));
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{4*a0^2+20*a0*a1+30*a1^2-88*a0-302*a1+826}{\[\displaystyle 4\,{{\it a0}}^{2}+20\,{\it a0}\,{\it a1}+30\,{{\it a1}}^{2}-88\,{\it a0}-302\,{\it a1}+826\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{plot3d(fS(a0,a1),a0=-20..20,a1=0..20);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{C8_LeastSquareFitplot3d3.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{eqs:=\{diff(expand(S),a0)=0,
diff(expand(S),a1)=0\};
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{eqs := {8*a0+20*a1-88 = 0, 20*a0+60*a1-302 = 0}}{\[\displaystyle {\it eqs}\, := \, \left\{ 8\,{\it a0}+20\,{\it a1}-88=0,20\,{\it a0}+60\,{\it a1}-302=0 \right\} \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{solve(eqs,\{a0,a1\});
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{{a0 = -19/2, a1 = 41/5}}{\[\displaystyle  \left\{ {\it a0}=-19/2,{\it a1}={\frac {41}{5}} \right\} \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{}{}
\end{mapleinput}
\end{maplegroup}
\section{\textbf{正規方程式による解}}
\begin{maplelatex}\begin{Maple Normal}{
より一般的な場合の最小二乗法の解法を説明する．先程の例では1次の多項式を近似関数とした．これをより一般的な関数，例えば，sin, cos, tan, exp, sinhなどとする．これを線形につないだ関数を}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{Typesetting:-mrow(Typesetting:-mi("F", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic")), family = "Times", mathvariant = "normal"), Typesetting:-mo("=", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-msub(Typesetting:-mi("a", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("0", family = "Times", mathvariant = "normal")), subscriptshift = "0"), Typesetting:-mi("sin", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic")), family = "Times", mathvariant = "normal"), Typesetting:-mo("+", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2222222em", rspace = "0.2222222em"), Typesetting:-msub(Typesetting:-mi("a", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), subscriptshift = "0"), Typesetting:-mi("cos", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic")), family = "Times", mathvariant = "normal"), Typesetting:-mo("+", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2222222em", rspace = "0.2222222em"), Typesetting:-msub(Typesetting:-mi("a", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("2", family = "Times", mathvariant = "normal")), subscriptshift = "0"), Typesetting:-mi("exp", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mo("&uminus0;", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2222222em", rspace = "0.2222222em"), Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic")), family = "Times", mathvariant = "normal"), Typesetting:-mo("+", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2222222em", rspace = "0.2222222em"), Typesetting:-msub(Typesetting:-mi("a", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("3", family = "Times", mathvariant = "normal")), subscriptshift = "0"), Typesetting:-mi("sinh", family = "Times", italic = "false", mathvariant = "normal"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic")), family = "Times", mathvariant = "normal"), Typesetting:-mo("+", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2222222em", rspace = "0.2222222em"), Typesetting:-mo("&ctdot;", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mo("=", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-munderover(Typesetting:-mo("&Sum;", family = "Times", mathvariant = "normal", fence = "unset", separator = "unset", stretchy = "true", symmetric = "unset", largeop = "true", movablelimits = "true", accent = "unset", lspace = "0.0em", rspace = "0.1666667em"), Typesetting:-mrow(Typesetting:-mi("k", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mo("=", family = "Times", mathvariant = "normal", fence = "unset", separator = "unset", stretchy = "unset", symmetric = "unset", largeop = "unset", movablelimits = "unset", accent = "unset", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-mn("1", family = "Times", mathvariant = "normal")), Typesetting:-mrow(Typesetting:-mi("M", family = "Times", italic = "true", mathvariant = "italic")), accent = "false", accentunder = "false"), Typesetting:-msub(Typesetting:-mi("a", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mi("k", family = "Times", italic = "true", mathvariant = "italic")), subscriptshift = "0"), Typesetting:-msub(Typesetting:-mi("X", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mi("k", family = "Times", italic = "true", mathvariant = "italic")), subscriptshift = "0"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic")), family = "Times", mathvariant = "normal"))}{\[\displaystyle F \left(x \right)=a _{0}\sin \left(x \right)+a _{1}\cos \left(x \right)+a _{2}\exp \left(-x \right)+a _{3}\sinh \left(x \right)+\esctdot =\Mapleoverset{M }{\Mapleunderset{k =1}{\sum }}a _{k }X _{k }\left(x \right)\]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
ととる．実際には，\mapleinline{inert}{2d}{X[k](x)}{$\displaystyle X_{{k}} \left( x \right) $}
はモデルや，多項式の高次項など論拠のある関数列をとる．これらを基底関数(base functions)と呼ぶ．ここで線形といっているのは，パラメータ\mapleinline{inert}{2d}{a[k]}{$\displaystyle a_{{k}}$}
について線形という意味である．この応用を次節で取り上げる．}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
このような，より一般的な基底関数を使っても，\mapleinline{inert}{2d}{chi^2}{$\displaystyle {\chi}^{2}$}
関数は}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{chi^2 = sum((F(x[i])-y[i])^2, i = 1 .. N)}{$\displaystyle {\chi}^{2}=\sum _{i=1}^{N} \left( F \left( x_{{i}} \right) -y_{{i}} \right) ^{2}$}
=\mapleinline{inert}{2d}{sum((sum(a[k]*X[k](x[i]), k = 1 .. M)-y[i])^2, i = 1 .. N)}{$\displaystyle \sum _{i=1}^{N} \left(  \left( \sum _{k=1}^{M}a_{{k}}X_{{k}} \left( x_{{i}} \right) -y_{{i}} \right) ^{2} \right) $}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
と求めることができる．この関数を，\mapleinline{inert}{2d}{a[k]}{$\displaystyle a_{{k}}$}
を変数とする関数とみなす．この関数が最小値を取るのは，\mapleinline{inert}{2d}{chi^2}{$\displaystyle {\chi}^{2}$}
を\mapleinline{inert}{2d}{M}{$\displaystyle M$}
個の\mapleinline{inert}{2d}{a[k]}{$\displaystyle a_{{k}}$}
で偏微分した式がすべて0となる場合である．これは}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{sum((sum(a[j]*X[j](x[i]), j = 1 .. M)-y[i])*X[k](x[i]), i = 1 .. N) = 0}{\[\displaystyle \sum _{i=1}^{N} \left(  \left( \sum _{j=1}^{M}a_{{j}}X_{{j}} \left( x_{{i}} \right) -y_{{i}} \right) X_{{k}} \left( x_{{i}} \right) \\
\mbox{} \right) =0\]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
ここで，\mapleinline{inert}{2d}{k = 1, () .. (), M}{$\displaystyle k=1,\,{\ldots },\,M$}
の\mapleinline{inert}{2d}{M}{$\displaystyle M$}
個の連立方程式である．この連立方程式を最小二乗法の正規方程式(normal equations)と呼ぶ．}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
上記の記法のままでは，ややこしいので，行列形式で書き直す．\mapleinline{inert}{2d}{Typesetting:-delayCrossProduct(N, M)}{$\displaystyle {\it delayCrossProduct} \left( N,M \right) $}
で，各要素を}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{A[ij] = X[j](x[i])}{\[\displaystyle A_{{{\it ij}}}=X_{{j}} \left( x_{{i}} \right) \]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
とする行列\mapleinline{inert}{2d}{A}{$\displaystyle A$}
を導入する．この行列は，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
\mapleinline{inert}{2d}{Typesetting:-mrow(Typesetting:-mi("A", family = "Times", size = "14", bold = "true", italic = "true", mathvariant = "bold-italic", fontweight = "bold"), Typesetting:-mo("=", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-maction(Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mtable(Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("X", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), subscriptshift = "0"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), subscriptshift = "0")), family = "Times", mathvariant = "normal")), Typesetting:-mi("")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("X", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("2", family = "Times", mathvariant = "normal")), subscriptshift = "0"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), subscriptshift = "0")), family = "Times", mathvariant = "normal")), Typesetting:-mi("")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&ctdot;", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("X", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mi("M", family = "Times", italic = "true", mathvariant = "italic")), subscriptshift = "0"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("x", family = "Times", italic = "true", mathvariant = "italic"), Typesetting:-mrow(Typesetting:-mn("1", family = "Times", mathvariant = "normal")), subscriptshift = "0")), family = "Times", mathvariant = "normal")), Typesetting:-mi("")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&ctdot;", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&ctdot;", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mo("&vellip;", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mo("&vellip;", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mo("&ctdot;", family = "Times", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), align = "axis", rowalign = "baseline", columnalign = "center", groupalign = "{left}", alignmentscope = "true", columnwidth = "auto", width = "auto", rowspacing = "1.0ex", columnspacing = "0.8em", rowlines = "none", columnlines = "none", frame = "none", framespacing = "0.4em 0.5ex", equalrows = "false", equalcolumns = "false", displaystyle = "false", side = "right", minlabelspacing = "0.8em"), Typesetting:-mi(""), Typesetting:-mi("")), family = "Times", mathvariant = "normal", Typesetting:-msemantics = "Matrix", open = "[", close = "]", Typesetting:-msemantics = "Matrix"), actiontype = "rtableaddress"), Typesetting:-mi(""))}{\[\displaystyle A =\]}
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
となる．これをデザイン行列と呼ぶ．すると先程の正規方程式は，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{A^T*A*a = A^T*y}{\[\displaystyle {A}^{T}Aa={A}^{T}y\]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
で与えられる．\mapleinline{inert}{2d}{A^T}{$\displaystyle {A}^{T}$}
は行列\mapleinline{inert}{2d}{A}{$\displaystyle A$}
の転置(transpose)を意味し，得られた行列は，\mapleinline{inert}{2d}{Typesetting:-delayCrossProduct(M, N)}{$\displaystyle {\it delayCrossProduct} \left( M,N \right) $}
である．\mapleinline{inert}{2d}{Typesetting:-mrow(Typesetting:-mi("a", family = "Times New Roman", size = "14", bold = "true", italic = "true", mathvariant = "bold-italic", fontweight = "bold"), Typesetting:-mo(",", family = "Times New Roman", size = "14", bold = "true", mathvariant = "bold", fontweight = "bold", fence = "false", separator = "true", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.3333333em"))}{$\displaystyle a ,$}
\mapleinline{inert}{2d}{y}{$\displaystyle y$}
はそれぞれ，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
\mapleinline{inert}{2d}{Typesetting:-mrow(Typesetting:-mi("a", family = "Times New Roman", size = "14", bold = "true", italic = "true", mathvariant = "bold-italic", fontweight = "bold"), Typesetting:-mo("=", family = "Times New Roman", size = "14", bold = "true", mathvariant = "bold", fontweight = "bold", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-maction(Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mtable(Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("a", family = "Times New Roman", bold = "true", italic = "false", mathvariant = "bold", fontweight = "bold"), Typesetting:-mrow(Typesetting:-mn("1", family = "Times New Roman", bold = "true", mathvariant = "bold", fontweight = "bold")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("a", family = "Times New Roman", bold = "true", italic = "false", mathvariant = "bold", fontweight = "bold"), Typesetting:-mrow(Typesetting:-mn("2", family = "Times New Roman", bold = "true", mathvariant = "bold", fontweight = "bold")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&vellip;", family = "Times New Roman", bold = "true", mathvariant = "bold", fontweight = "bold", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("a", family = "Times New Roman", bold = "true", italic = "false", mathvariant = "bold", fontweight = "bold"), Typesetting:-mrow(Typesetting:-mi("M", family = "Times New Roman", bold = "true", italic = "true", mathvariant = "bold-italic", fontweight = "bold")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), align = "axis", rowalign = "baseline", columnalign = "center", groupalign = "{left}", alignmentscope = "true", columnwidth = "auto", width = "auto", rowspacing = "1.0ex", columnspacing = "0.8em", rowlines = "none", columnlines = "none", frame = "none", framespacing = "0.4em 0.5ex", equalrows = "false", equalcolumns = "false", displaystyle = "false", side = "right", minlabelspacing = "0.8em"), Typesetting:-mi("")), family = "Times New Roman", size = "14", bold = "true", mathvariant = "bold", Typesetting:-msemantics = "ColVector", fontweight = "bold", open = "[", close = "]", Typesetting:-msemantics = "ColVector"), actiontype = "rtableaddress"), Typesetting:-mo(",", family = "Times New Roman", size = "14", bold = "true", mathvariant = "bold", fontweight = "bold", fence = "false", separator = "true", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.3333333em"), Typesetting:-mo(" ", family = "Times New Roman", size = "14", bold = "true", mathvariant = "bold", fontweight = "bold", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mi("y", family = "Times New Roman", size = "14", italic = "true", mathvariant = "italic"), Typesetting:-mo("=", family = "Times New Roman", size = "14", bold = "true", mathvariant = "bold", fontweight = "bold", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-maction(Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mtable(Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("y", family = "Times New Roman", bold = "true", italic = "false", mathvariant = "bold", fontweight = "bold"), Typesetting:-mrow(Typesetting:-mn("1", family = "Times New Roman", bold = "true", mathvariant = "bold", fontweight = "bold")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("y", family = "Times New Roman", bold = "true", italic = "false", mathvariant = "bold", fontweight = "bold"), Typesetting:-mrow(Typesetting:-mn("2", family = "Times New Roman", bold = "true", mathvariant = "bold", fontweight = "bold")), subscriptshift = "0")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&vellip;", family = "Times New Roman", bold = "true", mathvariant = "bold", fontweight = "bold", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-msub(Typesetting:-mi("y", family = "Times New Roman", bold = "true", italic = "false", mathvariant = "bold", fontweight = "bold"), Typesetting:-mrow(Typesetting:-mi("N", family = "Times New Roman", bold = "true", italic = "true", mathvariant = "bold-italic", fontweight = "bold")), subscriptshift = "0"), Typesetting:-mi("")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), align = "axis", rowalign = "baseline", columnalign = "center", groupalign = "{left}", alignmentscope = "true", columnwidth = "auto", width = "auto", rowspacing = "1.0ex", columnspacing = "0.8em", rowlines = "none", columnlines = "none", frame = "none", framespacing = "0.4em 0.5ex", equalrows = "false", equalcolumns = "false", displaystyle = "false", side = "right", minlabelspacing = "0.8em"), Typesetting:-mi("")), family = "Times New Roman", size = "14", bold = "true", mathvariant = "bold", Typesetting:-msemantics = "ColVector", fontweight = "bold", open = "[", close = "]", Typesetting:-msemantics = "ColVector"), actiontype = "rtableaddress"), Typesetting:-mi(""))}{\[\displaystyle a =,\mathop{\rm  }y =\]}
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
である．\mapleinline{inert}{2d}{M = 3, N = 25}{$\displaystyle M=3,\,N=25$}
として行列の次元だけで表現すると，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
\mapleinline{inert}{2d}{Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-maction(Typesetting:-mrow(Typesetting:-mrow(Typesetting:-mrow(Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mtable(Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mo("&ctdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&ctdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&ctdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&ctdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&ctdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&ctdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mo("&ctdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), align = "axis", rowalign = "baseline", columnalign = "center", groupalign = "{left}", alignmentscope = "true", columnwidth = "auto", width = "auto", rowspacing = "1.0ex", columnspacing = "0.8em", rowlines = "none", columnlines = "none", frame = "none", framespacing = "0.4em 0.5ex", equalrows = "false", equalcolumns = "false", displaystyle = "false", side = "right", minlabelspacing = "0.8em"), Typesetting:-mi("")), mathvariant = "normal", Typesetting:-msemantics = "Matrix", open = "[", close = "]", Typesetting:-msemantics = "Matrix"), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), actiontype = "rtableaddress"), Typesetting:-mi("")), Typesetting:-mi(""), Typesetting:-maction(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-maction(Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mtable(Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mo("&ctdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&vellip;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mo("&vellip;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mo("&vellip;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mo("&vellip;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&vellip;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&vellip;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), align = "axis", rowalign = "baseline", columnalign = "center", groupalign = "{left}", alignmentscope = "true", columnwidth = "auto", width = "auto", rowspacing = "1.0ex", columnspacing = "0.8em", rowlines = "none", columnlines = "none", frame = "none", framespacing = "0.4em 0.5ex", equalrows = "false", equalcolumns = "false", displaystyle = "false", side = "right", minlabelspacing = "0.8em"), Typesetting:-mi("")), mathvariant = "normal", Typesetting:-msemantics = "Matrix", open = "[", close = "]", Typesetting:-msemantics = "Matrix"), actiontype = "rtableaddress"), Typesetting:-mi("")), Typesetting:-mi("")), actiontype = "rtableaddress"), Typesetting:-mi(""))}{$\displaystyle $}
\mapleinline{inert}{2d}{Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-maction(Typesetting:-mrow(Typesetting:-mrow(Typesetting:-mrow(Typesetting:-mrow(Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mtable(Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&vellip;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mo("&vellip;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mo("&vellip;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), align = "axis", rowalign = "baseline", columnalign = "center", groupalign = "{left}", alignmentscope = "true", columnwidth = "auto", width = "auto", rowspacing = "1.0ex", columnspacing = "0.8em", rowlines = "none", columnlines = "none", frame = "none", framespacing = "0.4em 0.5ex", equalrows = "false", equalcolumns = "false", displaystyle = "false", side = "right", minlabelspacing = "0.8em"), Typesetting:-mi("")), mathvariant = "normal", Typesetting:-msemantics = "ColVector", open = "[", close = "]", Typesetting:-msemantics = "ColVector")), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), actiontype = "rtableaddress"), Typesetting:-mo("=", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.2777778em", rspace = "0.2777778em"), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-maction(Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mtable(Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mo("&ctdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&ctdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&ctdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&ctdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&ctdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&ctdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mo("&ctdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), Typesetting:-mtd(Typesetting:-mi(""), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), align = "axis", rowalign = "baseline", columnalign = "center", groupalign = "{left}", alignmentscope = "true", columnwidth = "auto", width = "auto", rowspacing = "1.0ex", columnspacing = "0.8em", rowlines = "none", columnlines = "none", frame = "none", framespacing = "0.4em 0.5ex", equalrows = "false", equalcolumns = "false", displaystyle = "false", side = "right", minlabelspacing = "0.8em"), Typesetting:-mi("")), mathvariant = "normal", Typesetting:-msemantics = "Matrix", open = "[", close = "]", Typesetting:-msemantics = "Matrix"), actiontype = "rtableaddress"), Typesetting:-mi(""), Typesetting:-maction(Typesetting:-mrow(Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mfenced(Typesetting:-mrow(Typesetting:-mi(""), Typesetting:-mtable(Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&sdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&sdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&sdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&sdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), Typesetting:-mtr(Typesetting:-mtd(Typesetting:-mrow(Typesetting:-mo("&sdot;", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em")), rowalign = "", columnalign = "", groupalign = "", rowspan = "1", columnspan = "1"), rowalign = "", columnalign = "", groupalign = ""), align = "axis", rowalign = "baseline", columnalign = "center", groupalign = "{left}", alignmentscope = "true", columnwidth = "auto", width = "auto", rowspacing = "1.0ex", columnspacing = "0.8em", rowlines = "none", columnlines = "none", frame = "none", framespacing = "0.4em 0.5ex", equalrows = "false", equalcolumns = "false", displaystyle = "false", side = "right", minlabelspacing = "0.8em"), Typesetting:-mi("")), mathvariant = "normal", Typesetting:-msemantics = "ColVector", open = "[", close = "]", Typesetting:-msemantics = "ColVector")), actiontype = "rtableaddress"), Typesetting:-mi(""), Typesetting:-mspace(height = "0.0ex", width = "0.0em", depth = "0.0ex", linebreak = "newline"), Typesetting:-mo(" ", mathvariant = "normal", fence = "false", separator = "false", stretchy = "false", symmetric = "false", largeop = "false", movablelimits = "false", accent = "false", lspace = "0.0em", rspace = "0.0em"), Typesetting:-mspace(height = "0.0ex", width = "0.0em", depth = "0.0ex", linebreak = "newline"), Typesetting:-mspace(height = "0.0ex", width = "0.0em", depth = "0.0ex", linebreak = "auto"), Typesetting:-mi(""))}{$\displaystyle =\mathop{\rm  }\mathop{\rm  }\mathop{\rm  }\mathop{\rm  }$}
}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
となる．これは少しの計算で\mapleinline{inert}{2d}{3*3}{$\displaystyle 9$}
の逆行列を解く問題に変形できる．}\end{Maple Normal}
\end{maplelatex}
\subsection{\textbf{正規方程式(normal equations)}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{restart;
X:=[1,2,3,4]:
Y:=[0,5,15,24]:
f1:=x->a[1]+a[2]*x+a[3]*x\symbol{94}2:
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{with(LinearAlgebra):
Av:=Matrix(1..4,1..3):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{ff:=(x,i)->x\symbol{94}(i-1);
for i from 1 to 3 do
for j from 1 to 4 do
  Av[j,i]:=ff(X[j],i);
end do;
end do;
Av;
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{ff := proc (x, i) options operator, arrow; x^(i-1) end proc}{\[\displaystyle {\it ff}\, := \,( {x,i} )\mapsto {x}^{i-1}\]}
\end{maplelatex}
\begin{maplelatex}
\mapleinline{inert}{2d}{Matrix(%id = 4398251072)}{\[\displaystyle  \left[ \begin {array}{ccc} 1&1&1\\ \noalign{\medskip}1&2&4\\ \noalign{\medskip}1&3&9\\ \noalign{\medskip}1&4&16\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{Ai:=MatrixInverse(Transpose(Av).Av);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{Ai := Matrix(%id = 4422629352)}{\[\displaystyle {\it Ai}\, := \, \left[ \begin {array}{ccc} {\frac {31}{4}}&-{\frac {27}{4}}&5/4\\ \noalign{\medskip}-{\frac {27}{4}}&{\frac {129}{20}}&-5/4\\ \noalign{\medskip}5/4&-5/4&1/4\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{b:=Transpose(Av).Vector(Y);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{b := Vector[column](%id = 4420341616)}{\[\displaystyle b\, := \, \left[ \begin {array}{c} 44\\ \noalign{\medskip}151\\ \noalign{\medskip}539\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{Ai.b;
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{Vector[column](%id = 4379731768)}{\[\displaystyle  \left[ \begin {array}{c} -9/2\\ \noalign{\medskip}{\frac {16}{5}}\\ \noalign{\medskip}1\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\subsection{\textbf{特異値分解(Singular Value Decomposition)}}
\begin{maplelatex}\begin{Maple Normal}{
正規方程式での共分散行列,特異値分解の導出や標準偏差との関係はNumRecipeを参照せよ．}\end{Maple Normal}
\end{maplelatex}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{restart;
X:=[1,2,3,4]:
Y:=[0,5,15,24]:
f1:=x->a[1]+a[2]*x+a[3]*x\symbol{94}2:
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{with(LinearAlgebra):
Av:=Matrix(1..4,1..3):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{ff:=(x,i)->x\symbol{94}(i-1):
for i from 1 to 3 do
for j from 1 to 4 do
  Av[j,i]:=ff(X[j],i);
end do;
end do;
Av;
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{Matrix(%id = 4403237456)}{\[\displaystyle  \left[ \begin {array}{ccc} 1&1&1\\ \noalign{\medskip}1&2&4\\ \noalign{\medskip}1&3&9\\ \noalign{\medskip}1&4&16\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{U,S,Vt:=evalf(SingularValues(Av,output=['U','S','Vt'])):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{DiagonalMatrix(S[1..3],4,3);
U.DiagonalMatrix(S[1..3],4,3).Vt:

}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{Matrix(%id = 4402823776)}{\[\displaystyle  \left[ \begin {array}{ccc}  19.6213640200000015&0&0\\ \noalign{\medskip}0& 1.71206987399999999&0\\ \noalign{\medskip}0&0& 0.266252879300000022\\ \noalign{\medskip}0&0&0\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{iS:=Vector(3):
for i from 1 to 3 do
iS[i]:=1/S[i];
end do:
DiS:=DiagonalMatrix(iS[1..3],3,4);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{DiS := Matrix(%id = 4394287928)}{\[\displaystyle {\it DiS}\, := \, \left[ \begin {array}{cccc}  0.05096485642&0&0&0\\ \noalign{\medskip}0& 0.5840883104&0&0\\ \noalign{\medskip}0&0& 3.755827928&0\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{Transpose(Vt).DiS.(Transpose(U).Vector(Y));
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{Vector[column](%id = 4417896320)}{\[\displaystyle  \left[ \begin {array}{c} - 4.50000000198176498\\ \noalign{\medskip} 3.20000000035008324\\ \noalign{\medskip} 1.00000000040565196\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\section{\textbf{2次元曲面へのフィット}}
\begin{maplelatex}\begin{Maple Normal}{
先程の一般化をより発展させると，3次元(\mapleinline{inert}{2d}{x[i], y[i], z[i]}{$\displaystyle x_{{i}},\,y_{{i}},\,z_{{i}}$}
)で提供されるデータへの，2次元平面でのフィットも可能となる．2次元の単純な曲面は，方程式を使って，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{F(x, y) = a[1]+a[2]*x+a[3]*y+a[4]*xy+a[5]*x^2+a[6]*y^2}{\[\displaystyle F \left( x,y \right) =a_{{1}}+a_{{2}}x+a_{{3}}y+a_{{4}}{\it xy}+a_{{5}}{x}^{2}+a_{{6}}{y}^{2}\]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
となる．デザイン行列の\mapleinline{inert}{2d}{i}{$\displaystyle i$}
行目の要素は，}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{center}
\begin{Maple Normal}{
\mapleinline{inert}{2d}{[1, x[i], y[i], x[i]*y[i], x[i]^2, y[i]^2]}{\[\displaystyle [1,x_{{i}},y_{{i}},x_{{i}}y_{{i}},{x_{{i}}}^{2},{y_{{i}}}^{2}]\]}
}\end{Maple Normal}
\end{center}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
として，それぞれ求める．このデータの変換の様子をMapleスクリプトで詳しく示した．後は，通常の正規方程式を解くようにすれば，このデータを近似する曲面を定めるパラメータ\mapleinline{inert}{2d}{a[1], a[2], `&ctdot;`(a[6])}{$\displaystyle a_{{1}},\,a_{{2}},\,\mbox {{\tt `\&ctdot;`}} \left( a_{{6}} \right) $}
が求まる．最小二乗法はパラメータ\mapleinline{inert}{2d}{a[k]}{$\displaystyle a_{{k}}$}
について線形であればよい．}\end{Maple Normal}
\end{maplelatex}
\begin{maplelatex}\begin{Maple Normal}{
}\end{Maple Normal}
\end{maplelatex}
\subsection{\textbf{xy平面への応用}}
\begin{maplelatex}\begin{Maple Normal}{
実際のデータ解析での例．データの座標をx,y,zで用意して，Mapleの埋め込み関数のleastsquareでfitしている．}\end{Maple Normal}
\end{maplelatex}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{with(plots):with(plottools):
z:=[0.000046079702088,   0.000029479057275,   0.000025769637830,   0.000034951410953,   0.000057024385455,
   0.000029485453808,   0.000011519913869,   0.000006442404299,   0.000014252898382,   0.000034951410953,
   0.000025769637773,   0.000006442404242,   0.000000000000057,   0.000006442404242,   0.000025769637773,
   0.000034932221524,   0.000014246501905,   0.000006442404299,   0.000011519913926,   0.000029479057332,
   0.000056973214100,   0.000034932221467,   0.000025769637773,   0.000029485453808,   0.000046079702031]:
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{x:=[]:
y:=[]:
p1:=2:
for i from -p1 to p1 do
  for j from -p1 to p1 do
    x:=[op(x),i*0.0005];
    y:=[op(y),j*0.0005];
  end do;
end do;
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{with(LinearAlgebra):
p2:=convert(Transpose(Matrix([x,y,z])),listlist):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{pp2:=pointplot3d(p2,symbol=circle,symbolsize=30,color=black):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{with(stats):
data:=[x,y,z]:
fit1:=fit[leastsquare[[t,s,u], 
    u=a0+a1*t+a2*s+a3*t*s+a4*t\symbol{94}2+a5*s\symbol{94}2, 
    \{a0,a1,a2,a3,a4,a5\}]](data);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{fit1 := u = -8.657142857*10^(-13)-0.6396456800e-5*t+0.6396438400e-5*s-5.459553587*t*s+25.76962838*t^2+25.76962835*s^2}{\[\displaystyle {\it fit1}\, := \,u=-{ 8.657142857\times 10^{-13}}\\
\mbox{}- 0.000006396456800\,t\\
\mbox{}+ 0.000006396438400\,s- 5.459553587\,ts\\
\mbox{}+ 25.76962838\,{t}^{2}+ 25.76962835\,{s}^{2}\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{f1:=unapply(rhs(fit1),(s,t)):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{pf1:=plot3d(f1(ss,uu),ss=-0.001..0.001,uu=-0.001..0.001,color=gray):
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{display(pf1,pp2,axes=boxed);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{C8_LeastSquareFitplot3d4.eps}
\end{maplegroup}
\subsection{\textbf{正規方程式による解法}}
\begin{maplegroup}
\begin{Maple Normal}{
デザイン行列へのデータ変換}\end{Maple Normal}

\textbf{bb:=Vector(25):}\textbf{A:=Matrix(25,6):}\textbf{p1:=2:}\textbf{for i from 1 to 25 do}\textbf{A[i,1]:=1;}\textbf{A[i,2]:=x[i];}\textbf{A[i,3]:=y[i];}\textbf{A[i,4]:=x[i]*y[i];}\textbf{A[i,5]:=x[i]\symbol{94}2;}\textbf{A[i,6]:=y[i]\symbol{94}2;}\textbf{bb[i]:=z[i];}\textbf{end do:}\end{maplegroup}
\begin{maplegroup}
\begin{Maple Normal}{
正規方程式の解}\end{Maple Normal}

\textbf{MatrixInverse(Transpose(A).A).(Transpose(A).bb);}\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{Vector[column](%id = 4399894384)}{\[\displaystyle  \left[ \begin {array}{c} -{ 9.185257196\times 10^{-13}}\\ \noalign{\medskip}- 0.00000639644675999994798\\ \noalign{\medskip} 0.00000639644220000032532\\ \noalign{\medskip}- 5.45955358336000173\\ \noalign{\medskip} 25.7696284050857187\\ \noalign{\medskip} 25.7696284050857543\end {array} \right] \]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{}{}
\end{mapleinput}
\end{maplegroup}
\section{\textbf{課題}}
\subsection{\textbf{1 1次元の線形最小二乗法}}
\begin{maplegroup}
\begin{Maple Normal}{
次の4点のデータを\mapleinline{inert}{2d}{y = a[1]+a[2]*x+a[3]*x^2}{$\displaystyle y=a_{{1}}+a_{{2}}x+a_{{3}}{x}^{2}$}
で近似せよ(2006年度期末試験)．}\end{Maple Normal}

\begin{Maple Normal}{
X:=[0,1,2,3];}\end{Maple Normal}

\begin{Maple Normal}{
Y:=[1,3,4,10];}\end{Maple Normal}
\end{maplegroup}
\subsection{\textbf{2}\textbf{2次元の最小二乗フィット}}
\begin{maplegroup}
\begin{Maple Normal}{
以下のデータを}\end{Maple Normal}

\begin{Maple Normal}{
\mapleinline{inert}{2d}{f(x, y) = a[1]+a[2]*x+a[3]*y+a[4]*xy}{\[\displaystyle f \left( x,y \right) =a_{{1}}+a_{{2}}x+a_{{3}}y+a_{{4}}{\it xy}\]}
}\end{Maple Normal}
\begin{Maple Normal}{
で近似せよ}\end{Maple Normal}

\begin{Maple Normal}{
x,   y,   z}\end{Maple Normal}

\begin{Maple Normal}{
-1,  -1,   2.00000}\end{Maple Normal}

\begin{Maple Normal}{
-1,   0,   0.50000}\end{Maple Normal}

\begin{Maple Normal}{
-1,   1,  -1.00000}\end{Maple Normal}

\begin{Maple Normal}{
0,  -1,   0.50000}\end{Maple Normal}

\begin{Maple Normal}{
0,   0,   1.00000}\end{Maple Normal}

\begin{Maple Normal}{
0,   1,   1.50000}\end{Maple Normal}

\begin{Maple Normal}{
1,  -1,  -1.00000}\end{Maple Normal}

\begin{Maple Normal}{
1,   0,   1.50000}\end{Maple Normal}

\begin{Maple Normal}{
1,   1,   4.00000}\end{Maple Normal}
\end{maplegroup}
\end{document}
